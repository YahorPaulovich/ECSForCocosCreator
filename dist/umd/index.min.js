/*! *****************************************************************************
 *
 * miski
 * v0.6.0
 *
 * MIT License
 * 
 * Copyright (C) 2021 Peter Hughes<https://www.phugh.es>, all rights reserved.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
***************************************************************************** */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):(t="undefined"!=typeof globalThis?globalThis:t||self,function(){var r=t.miski,n=t.miski={};e(n),n.noConflict=function(){return t.miski=r,n}}())}(this,(function(t){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},r=function(t){return t&&t.Math==Math&&t},n=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof e&&e)||function(){return this}()||Function("return this")(),o={},i=function(t){try{return!!t()}catch(t){return!0}},a=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),u={},f={}.propertyIsEnumerable,c=Object.getOwnPropertyDescriptor,s=c&&!f.call({1:2},1);u.f=s?function(t){var e=c(this,t);return!!e&&e.enumerable}:f;var l,p,y=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},h={}.toString,d=function(t){return h.call(t).slice(8,-1)},g=d,v="".split,w=i((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==g(t)?v.call(t,""):Object(t)}:Object,m=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},b=w,E=m,T=function(t){return b(E(t))},S=function(t){return"object"==typeof t?null!==t:"function"==typeof t},A=n,O=function(t){return"function"==typeof t?t:void 0},I=function(t,e){return arguments.length<2?O(A[t]):A[t]&&A[t][e]},R=I("navigator","userAgent")||"",_=n,j=R,x=_.process,P=_.Deno,M=x&&x.versions||P&&P.version,N=M&&M.v8;N?p=(l=N.split("."))[0]<4?1:l[0]+l[1]:j&&(!(l=j.match(/Edge\/(\d+)/))||l[1]>=74)&&(l=j.match(/Chrome\/(\d+)/))&&(p=l[1]);var C=p&&+p,D=C,U=i,F=!!Object.getOwnPropertySymbols&&!U((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&D&&D<41})),Y=F&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,k=I,V=Y?function(t){return"symbol"==typeof t}:function(t){var e=k("Symbol");return"function"==typeof e&&Object(t)instanceof e},q=S,B={exports:{}},L=n,W=function(t,e){try{Object.defineProperty(L,t,{value:e,configurable:!0,writable:!0})}catch(r){L[t]=e}return e},$=W,z="__core-js_shared__",G=n[z]||$(z,{}),K=G;(B.exports=function(t,e){return K[t]||(K[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.16.0",mode:"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"});var Q=m,Z=function(t){return Object(Q(t))},X=Z,H={}.hasOwnProperty,J=Object.hasOwn||function(t,e){return H.call(X(t),e)},tt=0,et=Math.random(),rt=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++tt+et).toString(36)},nt=n,ot=B.exports,it=J,at=rt,ut=F,ft=Y,ct=ot("wks"),st=nt.Symbol,lt=ft?st:st&&st.withoutSetter||at,pt=function(t){return it(ct,t)&&(ut||"string"==typeof ct[t])||(ut&&it(st,t)?ct[t]=st[t]:ct[t]=lt("Symbol."+t)),ct[t]},yt=S,ht=V,dt=function(t,e){var r,n;if("string"===e&&"function"==typeof(r=t.toString)&&!q(n=r.call(t)))return n;if("function"==typeof(r=t.valueOf)&&!q(n=r.call(t)))return n;if("string"!==e&&"function"==typeof(r=t.toString)&&!q(n=r.call(t)))return n;throw TypeError("Can't convert object to primitive value")},gt=pt("toPrimitive"),vt=function(t,e){if(!yt(t)||ht(t))return t;var r,n=t[gt];if(void 0!==n){if(void 0===e&&(e="default"),r=n.call(t,e),!yt(r)||ht(r))return r;throw TypeError("Can't convert object to primitive value")}return void 0===e&&(e="number"),dt(t,e)},wt=V,mt=function(t){var e=vt(t,"string");return wt(e)?e:String(e)},bt=S,Et=n.document,Tt=bt(Et)&&bt(Et.createElement),St=function(t){return Tt?Et.createElement(t):{}},At=St,Ot=!a&&!i((function(){return 7!=Object.defineProperty(At("div"),"a",{get:function(){return 7}}).a})),It=a,Rt=u,_t=y,jt=T,xt=mt,Pt=J,Mt=Ot,Nt=Object.getOwnPropertyDescriptor;o.f=It?Nt:function(t,e){if(t=jt(t),e=xt(e),Mt)try{return Nt(t,e)}catch(t){}if(Pt(t,e))return _t(!Rt.f.call(t,e),t[e])};var Ct={},Dt=S,Ut=function(t){if(!Dt(t))throw TypeError(String(t)+" is not an object");return t},Ft=a,Yt=Ot,kt=Ut,Vt=mt,qt=Object.defineProperty;Ct.f=Ft?qt:function(t,e,r){if(kt(t),e=Vt(e),kt(r),Yt)try{return qt(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(t[e]=r.value),t};var Bt=Ct,Lt=y,Wt=a?function(t,e,r){return Bt.f(t,e,Lt(1,r))}:function(t,e,r){return t[e]=r,t},$t={exports:{}},zt=G,Gt=Function.toString;"function"!=typeof zt.inspectSource&&(zt.inspectSource=function(t){return Gt.call(t)});var Kt,Qt,Zt,Xt=zt.inspectSource,Ht=Xt,Jt=n.WeakMap,te="function"==typeof Jt&&/native code/.test(Ht(Jt)),ee=B.exports,re=rt,ne=ee("keys"),oe=function(t){return ne[t]||(ne[t]=re(t))},ie={},ae=te,ue=S,fe=Wt,ce=J,se=G,le=oe,pe=ie,ye="Object already initialized",he=n.WeakMap;if(ae||se.state){var de=se.state||(se.state=new he),ge=de.get,ve=de.has,we=de.set;Kt=function(t,e){if(ve.call(de,t))throw new TypeError(ye);return e.facade=t,we.call(de,t,e),e},Qt=function(t){return ge.call(de,t)||{}},Zt=function(t){return ve.call(de,t)}}else{var me=le("state");pe[me]=!0,Kt=function(t,e){if(ce(t,me))throw new TypeError(ye);return e.facade=t,fe(t,me,e),e},Qt=function(t){return ce(t,me)?t[me]:{}},Zt=function(t){return ce(t,me)}}var be={set:Kt,get:Qt,has:Zt,enforce:function(t){return Zt(t)?Qt(t):Kt(t,{})},getterFor:function(t){return function(e){var r;if(!ue(e)||(r=Qt(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return r}}},Ee=n,Te=Wt,Se=J,Ae=W,Oe=Xt,Ie=be.get,Re=be.enforce,_e=String(String).split("String");($t.exports=function(t,e,r,n){var o,i=!!n&&!!n.unsafe,a=!!n&&!!n.enumerable,u=!!n&&!!n.noTargetGet;"function"==typeof r&&("string"!=typeof e||Se(r,"name")||Te(r,"name",e),(o=Re(r)).source||(o.source=_e.join("string"==typeof e?e:""))),t!==Ee?(i?!u&&t[e]&&(a=!0):delete t[e],a?t[e]=r:Te(t,e,r)):a?t[e]=r:Ae(e,r)})(Function.prototype,"toString",(function(){return"function"==typeof this&&Ie(this).source||Oe(this)}));var je={},xe=Math.ceil,Pe=Math.floor,Me=function(t){return isNaN(t=+t)?0:(t>0?Pe:xe)(t)},Ne=Me,Ce=Math.min,De=function(t){return t>0?Ce(Ne(t),9007199254740991):0},Ue=Me,Fe=Math.max,Ye=Math.min,ke=function(t,e){var r=Ue(t);return r<0?Fe(r+e,0):Ye(r,e)},Ve=T,qe=De,Be=ke,Le=function(t){return function(e,r,n){var o,i=Ve(e),a=qe(i.length),u=Be(n,a);if(t&&r!=r){for(;a>u;)if((o=i[u++])!=o)return!0}else for(;a>u;u++)if((t||u in i)&&i[u]===r)return t||u||0;return!t&&-1}},We={includes:Le(!0),indexOf:Le(!1)},$e=J,ze=T,Ge=We.indexOf,Ke=ie,Qe=function(t,e){var r,n=ze(t),o=0,i=[];for(r in n)!$e(Ke,r)&&$e(n,r)&&i.push(r);for(;e.length>o;)$e(n,r=e[o++])&&(~Ge(i,r)||i.push(r));return i},Ze=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Xe=Qe,He=Ze.concat("length","prototype");je.f=Object.getOwnPropertyNames||function(t){return Xe(t,He)};var Je={};Je.f=Object.getOwnPropertySymbols;var tr=je,er=Je,rr=Ut,nr=I("Reflect","ownKeys")||function(t){var e=tr.f(rr(t)),r=er.f;return r?e.concat(r(t)):e},or=J,ir=nr,ar=o,ur=Ct,fr=i,cr=/#|\.prototype\./,sr=function(t,e){var r=pr[lr(t)];return r==hr||r!=yr&&("function"==typeof e?fr(e):!!e)},lr=sr.normalize=function(t){return String(t).replace(cr,".").toLowerCase()},pr=sr.data={},yr=sr.NATIVE="N",hr=sr.POLYFILL="P",dr=sr,gr=n,vr=o.f,wr=Wt,mr=$t.exports,br=W,Er=function(t,e){for(var r=ir(e),n=ur.f,o=ar.f,i=0;i<r.length;i++){var a=r[i];or(t,a)||n(t,a,o(e,a))}},Tr=dr,Sr=function(t,e){var r,n,o,i,a,u=t.target,f=t.global,c=t.stat;if(r=f?gr:c?gr[u]||br(u,{}):(gr[u]||{}).prototype)for(n in e){if(i=e[n],o=t.noTargetGet?(a=vr(r,n))&&a.value:r[n],!Tr(f?n:u+(c?".":"#")+n,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;Er(i,o)}(t.sham||o&&o.sham)&&wr(i,"sham",!0),mr(r,n,i,t)}},Ar=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t},Or=Ut,Ir=Ar,Rr=function(){for(var t=Or(this),e=Ir(t.add),r=0,n=arguments.length;r<n;r++)e.call(t,arguments[r]);return t};Sr({target:"Set",proto:!0,real:!0,forced:false},{addAll:function(){return Rr.apply(this,arguments)}});var _r=Ut,jr=Ar,xr=function(){for(var t,e=_r(this),r=jr(e.delete),n=!0,o=0,i=arguments.length;o<i;o++)t=r.call(e,arguments[o]),n=n&&t;return!!n},Pr=xr;Sr({target:"Set",proto:!0,real:!0,forced:false},{deleteAll:function(){return Pr.apply(this,arguments)}});var Mr=Ut,Nr=Ar,Cr=pt("species"),Dr=function(t,e){var r,n=Mr(t).constructor;return void 0===n||null==(r=Mr(n)[Cr])?e:Nr(r)},Ur={},Fr=Ur,Yr=pt("iterator"),kr=Array.prototype,Vr=function(t){return void 0!==t&&(Fr.Array===t||kr[Yr]===t)},qr=Ar,Br=function(t,e,r){if(qr(t),void 0===e)return t;switch(r){case 0:return function(){return t.call(e)};case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,o){return t.call(e,r,n,o)}}return function(){return t.apply(e,arguments)}},Lr={};Lr[pt("toStringTag")]="z";var Wr="[object z]"===String(Lr),$r=d,zr=pt("toStringTag"),Gr="Arguments"==$r(function(){return arguments}()),Kr=Wr?$r:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),zr))?r:Gr?$r(e):"Object"==(n=$r(e))&&"function"==typeof e.callee?"Arguments":n},Qr=Kr,Zr=Ur,Xr=pt("iterator"),Hr=function(t){if(null!=t)return t[Xr]||t["@@iterator"]||Zr[Qr(t)]},Jr=Ut,tn=Ut,en=Vr,rn=De,nn=Br,on=Hr,an=function(t){var e=t.return;if(void 0!==e)return Jr(e.call(t)).value},un=function(t,e){this.stopped=t,this.result=e},fn=function(t,e,r){var n,o,i,a,u,f,c,s=r&&r.that,l=!(!r||!r.AS_ENTRIES),p=!(!r||!r.IS_ITERATOR),y=!(!r||!r.INTERRUPTED),h=nn(e,s,1+l+y),d=function(t){return n&&an(n),new un(!0,t)},g=function(t){return l?(tn(t),y?h(t[0],t[1],d):h(t[0],t[1])):y?h(t,d):h(t)};if(p)n=t;else{if("function"!=typeof(o=on(t)))throw TypeError("Target is not iterable");if(en(o)){for(i=0,a=rn(t.length);a>i;i++)if((u=g(t[i]))&&u instanceof un)return u;return new un(!1)}n=o.call(t)}for(f=n.next;!(c=f.call(n)).done;){try{u=g(c.value)}catch(t){throw an(n),t}if("object"==typeof u&&u&&u instanceof un)return u}return new un(!1)},cn=I,sn=Ut,ln=Ar,pn=Dr,yn=fn;Sr({target:"Set",proto:!0,real:!0,forced:false},{difference:function(t){var e=sn(this),r=new(pn(e,cn("Set")))(e),n=ln(r.delete);return yn(t,(function(t){n.call(r,t)})),r}});var hn=function(t){return Set.prototype.values.call(t)},dn=Ut,gn=Br,vn=hn,wn=fn;Sr({target:"Set",proto:!0,real:!0,forced:false},{every:function(t){var e=dn(this),r=vn(e),n=gn(t,arguments.length>1?arguments[1]:void 0,3);return!wn(r,(function(t,r){if(!n(t,t,e))return r()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var mn=I,bn=Ut,En=Ar,Tn=Br,Sn=Dr,An=hn,On=fn;Sr({target:"Set",proto:!0,real:!0,forced:false},{filter:function(t){var e=bn(this),r=An(e),n=Tn(t,arguments.length>1?arguments[1]:void 0,3),o=new(Sn(e,mn("Set"))),i=En(o.add);return On(r,(function(t){n(t,t,e)&&i.call(o,t)}),{IS_ITERATOR:!0}),o}});var In=Ut,Rn=Br,_n=hn,jn=fn;Sr({target:"Set",proto:!0,real:!0,forced:false},{find:function(t){var e=In(this),r=_n(e),n=Rn(t,arguments.length>1?arguments[1]:void 0,3);return jn(r,(function(t,r){if(n(t,t,e))return r(t)}),{IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var xn=I,Pn=Ut,Mn=Ar,Nn=Dr,Cn=fn;Sr({target:"Set",proto:!0,real:!0,forced:false},{intersection:function(t){var e=Pn(this),r=new(Nn(e,xn("Set"))),n=Mn(e.has),o=Mn(r.add);return Cn(t,(function(t){n.call(e,t)&&o.call(r,t)})),r}});var Dn=Ut,Un=Ar,Fn=fn;Sr({target:"Set",proto:!0,real:!0,forced:false},{isDisjointFrom:function(t){var e=Dn(this),r=Un(e.has);return!Fn(t,(function(t,n){if(!0===r.call(e,t))return n()}),{INTERRUPTED:!0}).stopped}});var Yn=Ut,kn=Hr,Vn=I,qn=Ut,Bn=Ar,Ln=function(t){var e=kn(t);if("function"!=typeof e)throw TypeError(String(t)+" is not iterable");return Yn(e.call(t))},Wn=fn;Sr({target:"Set",proto:!0,real:!0,forced:false},{isSubsetOf:function(t){var e=Ln(this),r=qn(t),n=r.has;return"function"!=typeof n&&(r=new(Vn("Set"))(t),n=Bn(r.has)),!Wn(e,(function(t,e){if(!1===n.call(r,t))return e()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var $n=Ut,zn=Ar,Gn=fn;Sr({target:"Set",proto:!0,real:!0,forced:false},{isSupersetOf:function(t){var e=$n(this),r=zn(e.has);return!Gn(t,(function(t,n){if(!1===r.call(e,t))return n()}),{INTERRUPTED:!0}).stopped}});var Kn=Ut,Qn=hn,Zn=fn;Sr({target:"Set",proto:!0,real:!0,forced:false},{join:function(t){var e=Kn(this),r=Qn(e),n=void 0===t?",":String(t),o=[];return Zn(r,o.push,{that:o,IS_ITERATOR:!0}),o.join(n)}});var Xn=I,Hn=Ut,Jn=Ar,to=Br,eo=Dr,ro=hn,no=fn;Sr({target:"Set",proto:!0,real:!0,forced:false},{map:function(t){var e=Hn(this),r=ro(e),n=to(t,arguments.length>1?arguments[1]:void 0,3),o=new(eo(e,Xn("Set"))),i=Jn(o.add);return no(r,(function(t){i.call(o,n(t,t,e))}),{IS_ITERATOR:!0}),o}});var oo=Ut,io=Ar,ao=hn,uo=fn;Sr({target:"Set",proto:!0,real:!0,forced:false},{reduce:function(t){var e=oo(this),r=ao(e),n=arguments.length<2,o=n?void 0:arguments[1];if(io(t),uo(r,(function(r){n?(n=!1,o=r):o=t(o,r,r,e)}),{IS_ITERATOR:!0}),n)throw TypeError("Reduce of empty set with no initial value");return o}});var fo=Ut,co=Br,so=hn,lo=fn;Sr({target:"Set",proto:!0,real:!0,forced:false},{some:function(t){var e=fo(this),r=so(e),n=co(t,arguments.length>1?arguments[1]:void 0,3);return lo(r,(function(t,r){if(n(t,t,e))return r()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var po=I,yo=Ut,ho=Ar,go=Dr,vo=fn;Sr({target:"Set",proto:!0,real:!0,forced:false},{symmetricDifference:function(t){var e=yo(this),r=new(go(e,po("Set")))(e),n=ho(r.delete),o=ho(r.add);return vo(t,(function(t){n.call(r,t)||o.call(r,t)})),r}});var wo=I,mo=Ut,bo=Ar,Eo=Dr,To=fn;Sr({target:"Set",proto:!0,real:!0,forced:false},{union:function(t){var e=mo(this),r=new(Eo(e,wo("Set")))(e);return To(t,bo(r.add),{that:r}),r}});var So={exports:{}},Ao=pt("iterator"),Oo=!1;try{var Io=0,Ro={next:function(){return{done:!!Io++}},return:function(){Oo=!0}};Ro[Ao]=function(){return this},Array.from(Ro,(function(){throw 2}))}catch(t){}var _o,jo,xo,Po="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Mo=!i((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),No=J,Co=Z,Do=Mo,Uo=oe("IE_PROTO"),Fo=Object.prototype,Yo=Do?Object.getPrototypeOf:function(t){return t=Co(t),No(t,Uo)?t[Uo]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Fo:null},ko=S,Vo=Ut,qo=function(t){if(!ko(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t},Bo=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),e=r instanceof Array}catch(t){}return function(r,n){return Vo(r),qo(n),e?t.call(r,n):r.__proto__=n,r}}():void 0),Lo=Po,Wo=a,$o=n,zo=S,Go=J,Ko=Kr,Qo=Wt,Zo=$t.exports,Xo=Ct.f,Ho=Yo,Jo=Bo,ti=pt,ei=rt,ri=$o.Int8Array,ni=ri&&ri.prototype,oi=$o.Uint8ClampedArray,ii=oi&&oi.prototype,ai=ri&&Ho(ri),ui=ni&&Ho(ni),fi=Object.prototype,ci=fi.isPrototypeOf,si=ti("toStringTag"),li=ei("TYPED_ARRAY_TAG"),pi=ei("TYPED_ARRAY_CONSTRUCTOR"),yi=Lo&&!!Jo&&"Opera"!==Ko($o.opera),hi=!1,di={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},gi={BigInt64Array:8,BigUint64Array:8},vi=function(t){if(!zo(t))return!1;var e=Ko(t);return Go(di,e)||Go(gi,e)};for(_o in di)(xo=(jo=$o[_o])&&jo.prototype)?Qo(xo,pi,jo):yi=!1;for(_o in gi)(xo=(jo=$o[_o])&&jo.prototype)&&Qo(xo,pi,jo);if((!yi||"function"!=typeof ai||ai===Function.prototype)&&(ai=function(){throw TypeError("Incorrect invocation")},yi))for(_o in di)$o[_o]&&Jo($o[_o],ai);if((!yi||!ui||ui===fi)&&(ui=ai.prototype,yi))for(_o in di)$o[_o]&&Jo($o[_o].prototype,ui);if(yi&&Ho(ii)!==ui&&Jo(ii,ui),Wo&&!Go(ui,si))for(_o in hi=!0,Xo(ui,si,{get:function(){return zo(this)?this[li]:void 0}}),di)$o[_o]&&Qo($o[_o],li,_o);var wi={NATIVE_ARRAY_BUFFER_VIEWS:yi,TYPED_ARRAY_CONSTRUCTOR:pi,TYPED_ARRAY_TAG:hi&&li,aTypedArray:function(t){if(vi(t))return t;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(t){if(Jo&&!ci.call(ai,t))throw TypeError("Target is not a typed array constructor");return t},exportTypedArrayMethod:function(t,e,r){if(Wo){if(r)for(var n in di){var o=$o[n];if(o&&Go(o.prototype,t))try{delete o.prototype[t]}catch(t){}}ui[t]&&!r||Zo(ui,t,r?e:yi&&ni[t]||e)}},exportTypedArrayStaticMethod:function(t,e,r){var n,o;if(Wo){if(Jo){if(r)for(n in di)if((o=$o[n])&&Go(o,t))try{delete o[t]}catch(t){}if(ai[t]&&!r)return;try{return Zo(ai,t,r?e:yi&&ai[t]||e)}catch(t){}}for(n in di)!(o=$o[n])||o[t]&&!r||Zo(o,t,e)}},isView:function(t){if(!zo(t))return!1;var e=Ko(t);return"DataView"===e||Go(di,e)||Go(gi,e)},isTypedArray:vi,TypedArray:ai,TypedArrayPrototype:ui},mi=n,bi=i,Ei=function(t,e){if(!e&&!Oo)return!1;var r=!1;try{var n={};n[Ao]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch(t){}return r},Ti=wi.NATIVE_ARRAY_BUFFER_VIEWS,Si=mi.ArrayBuffer,Ai=mi.Int8Array,Oi=!Ti||!bi((function(){Ai(1)}))||!bi((function(){new Ai(-1)}))||!Ei((function(t){new Ai,new Ai(null),new Ai(1.5),new Ai(t)}),!0)||bi((function(){return 1!==new Ai(new Si(2),1,void 0).length})),Ii=$t.exports,Ri=function(t,e,r){if(!(t instanceof e))throw TypeError("Incorrect "+(r?r+" ":"")+"invocation");return t},_i=Me,ji=De,xi=function(t){if(void 0===t)return 0;var e=_i(t),r=ji(e);if(e!==r)throw RangeError("Wrong length or index");return r},Pi=Math.abs,Mi=Math.pow,Ni=Math.floor,Ci=Math.log,Di=Math.LN2,Ui={pack:function(t,e,r){var n,o,i,a=new Array(r),u=8*r-e-1,f=(1<<u)-1,c=f>>1,s=23===e?Mi(2,-24)-Mi(2,-77):0,l=t<0||0===t&&1/t<0?1:0,p=0;for((t=Pi(t))!=t||t===1/0?(o=t!=t?1:0,n=f):(n=Ni(Ci(t)/Di),t*(i=Mi(2,-n))<1&&(n--,i*=2),(t+=n+c>=1?s/i:s*Mi(2,1-c))*i>=2&&(n++,i/=2),n+c>=f?(o=0,n=f):n+c>=1?(o=(t*i-1)*Mi(2,e),n+=c):(o=t*Mi(2,c-1)*Mi(2,e),n=0));e>=8;a[p++]=255&o,o/=256,e-=8);for(n=n<<e|o,u+=e;u>0;a[p++]=255&n,n/=256,u-=8);return a[--p]|=128*l,a},unpack:function(t,e){var r,n=t.length,o=8*n-e-1,i=(1<<o)-1,a=i>>1,u=o-7,f=n-1,c=t[f--],s=127&c;for(c>>=7;u>0;s=256*s+t[f],f--,u-=8);for(r=s&(1<<-u)-1,s>>=-u,u+=e;u>0;r=256*r+t[f],f--,u-=8);if(0===s)s=1-a;else{if(s===i)return r?NaN:c?-1/0:1/0;r+=Mi(2,e),s-=a}return(c?-1:1)*r*Mi(2,s-e)}},Fi=Z,Yi=ke,ki=De,Vi=Ct.f,qi=J,Bi=pt("toStringTag"),Li=n,Wi=a,$i=Po,zi=Wt,Gi=function(t,e,r){for(var n in e)Ii(t,n,e[n],r);return t},Ki=i,Qi=Ri,Zi=Me,Xi=De,Hi=xi,Ji=Ui,ta=Yo,ea=Bo,ra=je.f,na=Ct.f,oa=function(t){for(var e=Fi(this),r=ki(e.length),n=arguments.length,o=Yi(n>1?arguments[1]:void 0,r),i=n>2?arguments[2]:void 0,a=void 0===i?r:Yi(i,r);a>o;)e[o++]=t;return e},ia=function(t,e,r){t&&!qi(t=r?t:t.prototype,Bi)&&Vi(t,Bi,{configurable:!0,value:e})},aa=be.get,ua=be.set,fa="ArrayBuffer",ca="DataView",sa="Wrong index",la=Li.ArrayBuffer,pa=la,ya=Li.DataView,ha=ya&&ya.prototype,da=Object.prototype,ga=Li.RangeError,va=Ji.pack,wa=Ji.unpack,ma=function(t){return[255&t]},ba=function(t){return[255&t,t>>8&255]},Ea=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},Ta=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},Sa=function(t){return va(t,23,4)},Aa=function(t){return va(t,52,8)},Oa=function(t,e){na(t.prototype,e,{get:function(){return aa(this)[e]}})},Ia=function(t,e,r,n){var o=Hi(r),i=aa(t);if(o+e>i.byteLength)throw ga(sa);var a=aa(i.buffer).bytes,u=o+i.byteOffset,f=a.slice(u,u+e);return n?f:f.reverse()},Ra=function(t,e,r,n,o,i){var a=Hi(r),u=aa(t);if(a+e>u.byteLength)throw ga(sa);for(var f=aa(u.buffer).bytes,c=a+u.byteOffset,s=n(+o),l=0;l<e;l++)f[c+l]=s[i?l:e-l-1]};if($i){if(!Ki((function(){la(1)}))||!Ki((function(){new la(-1)}))||Ki((function(){return new la,new la(1.5),new la(NaN),la.name!=fa}))){for(var _a,ja=(pa=function(t){return Qi(this,pa),new la(Hi(t))}).prototype=la.prototype,xa=ra(la),Pa=0;xa.length>Pa;)(_a=xa[Pa++])in pa||zi(pa,_a,la[_a]);ja.constructor=pa}ea&&ta(ha)!==da&&ea(ha,da);var Ma=new ya(new pa(2)),Na=ha.setInt8;Ma.setInt8(0,2147483648),Ma.setInt8(1,2147483649),!Ma.getInt8(0)&&Ma.getInt8(1)||Gi(ha,{setInt8:function(t,e){Na.call(this,t,e<<24>>24)},setUint8:function(t,e){Na.call(this,t,e<<24>>24)}},{unsafe:!0})}else pa=function(t){Qi(this,pa,fa);var e=Hi(t);ua(this,{bytes:oa.call(new Array(e),0),byteLength:e}),Wi||(this.byteLength=e)},ya=function(t,e,r){Qi(this,ya,ca),Qi(t,pa,ca);var n=aa(t).byteLength,o=Zi(e);if(o<0||o>n)throw ga("Wrong offset");if(o+(r=void 0===r?n-o:Xi(r))>n)throw ga("Wrong length");ua(this,{buffer:t,byteLength:r,byteOffset:o}),Wi||(this.buffer=t,this.byteLength=r,this.byteOffset=o)},Wi&&(Oa(pa,"byteLength"),Oa(ya,"buffer"),Oa(ya,"byteLength"),Oa(ya,"byteOffset")),Gi(ya.prototype,{getInt8:function(t){return Ia(this,1,t)[0]<<24>>24},getUint8:function(t){return Ia(this,1,t)[0]},getInt16:function(t){var e=Ia(this,2,t,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=Ia(this,2,t,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(t){return Ta(Ia(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return Ta(Ia(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return wa(Ia(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return wa(Ia(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,e){Ra(this,1,t,ma,e)},setUint8:function(t,e){Ra(this,1,t,ma,e)},setInt16:function(t,e){Ra(this,2,t,ba,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){Ra(this,2,t,ba,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){Ra(this,4,t,Ea,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){Ra(this,4,t,Ea,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){Ra(this,4,t,Sa,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,e){Ra(this,8,t,Aa,e,arguments.length>2?arguments[2]:void 0)}});ia(pa,fa),ia(ya,ca);var Ca,Da={ArrayBuffer:pa,DataView:ya},Ua=S,Fa=Math.floor,Ya=Me,ka=function(t){var e=Ya(t);if(e<0)throw RangeError("The argument can't be less than 0");return e},Va=Qe,qa=Ze,Ba=Object.keys||function(t){return Va(t,qa)},La=Ct,Wa=Ut,$a=Ba,za=a?Object.defineProperties:function(t,e){Wa(t);for(var r,n=$a(e),o=n.length,i=0;o>i;)La.f(t,r=n[i++],e[r]);return t},Ga=I("document","documentElement"),Ka=Ut,Qa=za,Za=Ze,Xa=ie,Ha=Ga,Ja=St,tu=oe("IE_PROTO"),eu=function(){},ru=function(t){return"<script>"+t+"</"+"script>"},nu=function(t){t.write(ru("")),t.close();var e=t.parentWindow.Object;return t=null,e},ou=function(){try{Ca=new ActiveXObject("htmlfile")}catch(t){}ou=document.domain&&Ca?nu(Ca):function(){var t,e=Ja("iframe");if(e.style)return e.style.display="none",Ha.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(ru("document.F=Object")),t.close(),t.F}()||nu(Ca);for(var t=Za.length;t--;)delete ou.prototype[Za[t]];return ou()};Xa[tu]=!0;var iu=Object.create||function(t,e){var r;return null!==t?(eu.prototype=Ka(t),r=new eu,eu.prototype=null,r[tu]=t):r=ou(),void 0===e?r:Qa(r,e)},au=Z,uu=De,fu=Hr,cu=Vr,su=Br,lu=wi.aTypedArrayConstructor,pu=d,yu=Array.isArray||function(t){return"Array"==pu(t)},hu=S,du=yu,gu=pt("species"),vu=function(t){var e;return du(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!du(e.prototype)?hu(e)&&null===(e=e[gu])&&(e=void 0):e=void 0),void 0===e?Array:e},wu=Br,mu=w,bu=Z,Eu=De,Tu=function(t,e){return new(vu(t))(0===e?0:e)},Su=[].push,Au=function(t){var e=1==t,r=2==t,n=3==t,o=4==t,i=6==t,a=7==t,u=5==t||i;return function(f,c,s,l){for(var p,y,h=bu(f),d=mu(h),g=wu(c,s,3),v=Eu(d.length),w=0,m=l||Tu,b=e?m(f,v):r||a?m(f,0):void 0;v>w;w++)if((u||w in d)&&(y=g(p=d[w],w,h),t))if(e)b[w]=y;else if(y)switch(t){case 3:return!0;case 5:return p;case 6:return w;case 2:Su.call(b,p)}else switch(t){case 4:return!1;case 7:Su.call(b,p)}return i?-1:n||o?o:b}},Ou={forEach:Au(0),map:Au(1),filter:Au(2),some:Au(3),every:Au(4),find:Au(5),findIndex:Au(6),filterReject:Au(7)},Iu=I,Ru=Ct,_u=a,ju=pt("species"),xu=S,Pu=Bo,Mu=Sr,Nu=n,Cu=a,Du=Oi,Uu=wi,Fu=Da,Yu=Ri,ku=y,Vu=Wt,qu=function(t){return!Ua(t)&&isFinite(t)&&Fa(t)===t},Bu=De,Lu=xi,Wu=function(t,e){var r=ka(t);if(r%e)throw RangeError("Wrong offset");return r},$u=mt,zu=J,Gu=Kr,Ku=S,Qu=V,Zu=iu,Xu=Bo,Hu=je.f,Ju=function(t){var e,r,n,o,i,a,u=au(t),f=arguments.length,c=f>1?arguments[1]:void 0,s=void 0!==c,l=fu(u);if(null!=l&&!cu(l))for(a=(i=l.call(u)).next,u=[];!(o=a.call(i)).done;)u.push(o.value);for(s&&f>2&&(c=su(c,arguments[2],2)),r=uu(u.length),n=new(lu(this))(r),e=0;r>e;e++)n[e]=s?c(u[e],e):u[e];return n},tf=Ou.forEach,ef=function(t){var e=Iu(t),r=Ru.f;_u&&e&&!e[ju]&&r(e,ju,{configurable:!0,get:function(){return this}})},rf=Ct,nf=o,of=function(t,e,r){var n,o;return Pu&&"function"==typeof(n=e.constructor)&&n!==r&&xu(o=n.prototype)&&o!==r.prototype&&Pu(t,o),t},af=be.get,uf=be.set,ff=rf.f,cf=nf.f,sf=Math.round,lf=Nu.RangeError,pf=Fu.ArrayBuffer,yf=Fu.DataView,hf=Uu.NATIVE_ARRAY_BUFFER_VIEWS,df=Uu.TYPED_ARRAY_CONSTRUCTOR,gf=Uu.TYPED_ARRAY_TAG,vf=Uu.TypedArray,wf=Uu.TypedArrayPrototype,mf=Uu.aTypedArrayConstructor,bf=Uu.isTypedArray,Ef="BYTES_PER_ELEMENT",Tf="Wrong length",Sf=function(t,e){for(var r=0,n=e.length,o=new(mf(t))(n);n>r;)o[r]=e[r++];return o},Af=function(t,e){ff(t,e,{get:function(){return af(this)[e]}})},Of=function(t){var e;return t instanceof pf||"ArrayBuffer"==(e=Gu(t))||"SharedArrayBuffer"==e},If=function(t,e){return bf(t)&&!Qu(e)&&e in t&&qu(+e)&&e>=0},Rf=function(t,e){return e=$u(e),If(t,e)?ku(2,t[e]):cf(t,e)},_f=function(t,e,r){return e=$u(e),!(If(t,e)&&Ku(r)&&zu(r,"value"))||zu(r,"get")||zu(r,"set")||r.configurable||zu(r,"writable")&&!r.writable||zu(r,"enumerable")&&!r.enumerable?ff(t,e,r):(t[e]=r.value,t)};Cu?(hf||(nf.f=Rf,rf.f=_f,Af(wf,"buffer"),Af(wf,"byteOffset"),Af(wf,"byteLength"),Af(wf,"length")),Mu({target:"Object",stat:!0,forced:!hf},{getOwnPropertyDescriptor:Rf,defineProperty:_f}),So.exports=function(t,e,r){var n=t.match(/\d+$/)[0]/8,o=t+(r?"Clamped":"")+"Array",i="get"+t,a="set"+t,u=Nu[o],f=u,c=f&&f.prototype,s={},l=function(t,e){ff(t,e,{get:function(){return function(t,e){var r=af(t);return r.view[i](e*n+r.byteOffset,!0)}(this,e)},set:function(t){return function(t,e,o){var i=af(t);r&&(o=(o=sf(o))<0?0:o>255?255:255&o),i.view[a](e*n+i.byteOffset,o,!0)}(this,e,t)},enumerable:!0})};hf?Du&&(f=e((function(t,e,r,i){return Yu(t,f,o),of(Ku(e)?Of(e)?void 0!==i?new u(e,Wu(r,n),i):void 0!==r?new u(e,Wu(r,n)):new u(e):bf(e)?Sf(f,e):Ju.call(f,e):new u(Lu(e)),t,f)})),Xu&&Xu(f,vf),tf(Hu(u),(function(t){t in f||Vu(f,t,u[t])})),f.prototype=c):(f=e((function(t,e,r,i){Yu(t,f,o);var a,u,c,s=0,p=0;if(Ku(e)){if(!Of(e))return bf(e)?Sf(f,e):Ju.call(f,e);a=e,p=Wu(r,n);var y=e.byteLength;if(void 0===i){if(y%n)throw lf(Tf);if((u=y-p)<0)throw lf(Tf)}else if((u=Bu(i)*n)+p>y)throw lf(Tf);c=u/n}else c=Lu(e),a=new pf(u=c*n);for(uf(t,{buffer:a,byteOffset:p,byteLength:u,length:c,view:new yf(a)});s<c;)l(t,s++)})),Xu&&Xu(f,vf),c=f.prototype=Zu(wf)),c.constructor!==f&&Vu(c,"constructor",f),Vu(c,df,f),gf&&Vu(c,gf,o),s[o]=f,Mu({global:!0,forced:f!=u,sham:!hf},s),Ef in f||Vu(f,Ef,n),Ef in c||Vu(c,Ef,n),ef(o)}):So.exports=function(){},(0,So.exports)("Uint32",(function(t){return function(e,r,n){return t(this,e,r,n)}}));var jf=Math.floor,xf=function(t,e){var r=t.length,n=jf(r/2);return r<8?Pf(t,e):Mf(xf(t.slice(0,n),e),xf(t.slice(n),e),e)},Pf=function(t,e){for(var r,n,o=t.length,i=1;i<o;){for(n=i,r=t[i];n&&e(t[n-1],r)>0;)t[n]=t[--n];n!==i++&&(t[n]=r)}return t},Mf=function(t,e,r){for(var n=t.length,o=e.length,i=0,a=0,u=[];i<n||a<o;)i<n&&a<o?u.push(r(t[i],e[a])<=0?t[i++]:e[a++]):u.push(i<n?t[i++]:e[a++]);return u},Nf=xf,Cf=R.match(/firefox\/(\d+)/i),Df=!!Cf&&+Cf[1],Uf=/MSIE|Trident/.test(R),Ff=R.match(/AppleWebKit\/(\d+)\./),Yf=!!Ff&&+Ff[1],kf=i,Vf=Ar,qf=De,Bf=Nf,Lf=Df,Wf=Uf,$f=C,zf=Yf,Gf=wi.aTypedArray,Kf=wi.exportTypedArrayMethod,Qf=n.Uint16Array,Zf=Qf&&Qf.prototype.sort,Xf=!!Zf&&!kf((function(){var t=new Qf(2);t.sort(null),t.sort({})})),Hf=!!Zf&&!kf((function(){if($f)return $f<74;if(Lf)return Lf<67;if(Wf)return!0;if(zf)return zf<602;var t,e,r=new Qf(516),n=Array(516);for(t=0;t<516;t++)e=t%4,r[t]=515-t,n[t]=t-2*e+3;for(r.sort((function(t,e){return(t/4|0)-(e/4|0)})),t=0;t<516;t++)if(r[t]!==n[t])return!0}));function Jf(t){return 32*t.length}function tc(t,e){if(!function(t,e){return!(e<0||e>Jf(t))}(t,e))throw new SyntaxError(`Bit ${e} does not exist on mask.`);return t[Math.floor(e/32)]|=1<<e%32,t}function ec(t){const e=Jf(t);let r=0;for(let n=0,o=t.length;n<o;n++)r+=(t[n]^e)+n%32;return parseInt(Math.abs(r).toString(8),8)}function rc(t,...e){const r=function(t=32){return new Uint32Array(Math.ceil(t/32))}(t.spec.maxComponents||32);if(!e.length)return r;for(let n=0,o=e.length;n<o;n++){const o=e[n];if(o.world.id!==t.id)throw new Error("Components are not from the same world.");tc(r,o.id)}return r}function nc(t,e){const r=t.length;if(!r)return t;for(;e<r;)t[e]=t[e+1],e++;return t.length=t.length-1,t}function oc(t){return Boolean("object"==typeof t&&!Array.isArray(t))}function ic(t){}Kf("sort",(function(t){var e=this;if(void 0!==t&&Vf(t),Hf)return Zf.call(e,t);Gf(e);var r,n=qf(e.length),o=Array(n);for(r=0;r<n;r++)o[r]=e[r];for(o=Bf(e,function(t){return function(e,r){return void 0!==t?+t(e,r)||0:r!=r?-1:e!=e?1:0===e&&0===r?1/e>0&&1/r<0?1:-1:e>r}}(t)),r=0;r<n;r++)e[r]=o[r];return e}),!Hf||Xf);const ac=/^(?![0-9])[a-zA-Z0-9$_]+$/;function uc(t){return"string"==typeof t&&((t=t.trim()).length>0&&ac.test(t)&&!fc.has(t))}const fc=new Set(["entities","id","instances","name","schema","world","constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","prototype","toLocaleString","toString","valueOf","__defineGetter__","__defineSetter__","__lookupGetter__","__lookupGetter__","__proto__"]);function cc(t,e){for(let r=0,n=t.and.length;r<n;r++){const n=e.mask[r];if(0!=(t.not[r]&n))return!1;if((t.and[r]&n)!==t.and[r])return!1;if((t.or[r]&n)>0)return!1}return!0}function sc(t,e){return-1!==t.archetypes.indexOf(e)||t.archetypes.push(e),t}function lc(t,e){const r=t.archetypes.indexOf(e);return-1===r||nc(t.archetypes,r),t}function pc(t){return t.components}function yc(t){return[...t.entities]}function hc(t){return t.archetypes.flatMap(yc)}var dc;!function(t){t[t.EMPTY=-1]="EMPTY",t[t.DESTROYED=-2]="DESTROYED"}(dc||(dc={}));const gc=128,vc=1e4,wc=Symbol(),mc=Symbol();function bc(t,e,r,n=!1){const{archetypes:o,entities:i}=t;let a=[];const u=i[e];if(void 0===u||u<-1)throw new Error("Entity is not available!");if(u>-1){const r=o.get(u);r&&(a=[...r.components],r.entities.delete(e),0===r.entities.size&&function(t,e){const{archetypes:r,queries:n}=t,{id:o}=e;if(r.get(o)!==e)throw new Error("Archetype not found in world.");const i=[...n.values()];for(let t=0,r=i.length;t<r;t++)lc(i[t],e);r.delete(o)}(t,r))}if(r)if(!1===n)a.push(r);else{const t=a.indexOf(r);t>-1&&nc(a,t)}if(0===a.length)return i[e]=dc.EMPTY,null;const f=function(t,...e){const r=rc(t,...e);return{components:new Set(e),entities:new Set,mask:r,id:ec(r)}}(t,...a),{id:c}=f,s=o.get(c);if(void 0===s){const r=[...t.queries.values()];for(let t=0,e=r.length;t<e;t++){const e=r[t];cc(e,f)&&sc(e,f)}return i[e]=c,f.entities.add(e),o.set(c,f),f}return i[e]=s.id,s.entities.add(e),s}function Ec(t){if(!t)return!1;if(!oc(t))return!1;if(Object.hasOwnProperty.call(t,"schema")&&!oc(t=t.schema))return!1;const e=Object.values(t);return 0!==e.length&&e.every((t=>!0===t[mc]))}function Tc(t,e){const{initial:r,isTypedArray:n,prefill:o}=t;if(e<0||e>t.length)throw new SyntaxError("Entity is out of range.");try{delete t[e]}catch(r){if(!n)throw new Error(r);t[e]=0}return!0===o&&(t[e]=r()),t}function Sc(t,e,r){if(e<0||e>t.length)throw new SyntaxError("Entity is out of range.");if(!t.guard(r))throw new TypeError("Value is not correct type.");return t[e]=r,t}function Ac(t){const{name:e,initial:r,guard:n,arrayType:o=Array,prefill:i=!1}=t;if(!e||!n)throw new SyntaxError("Invalid datastore spec - mandatory properties missing.");if(!uc(e))throw new Error("Invalid name.");const a=r();if(!n(a))throw new TypeError("Initial property is of invalid type. Make sure guard(initial()) returns true.");const u=new o,f=function(t){return Boolean(ArrayBuffer.isView(t)&&!(t instanceof DataView))}(u);if(f&&("number"!=typeof a||isNaN(a)))throw new TypeError(`Initial property for typed array type must be a number. Found ${typeof a}.`);return Object.create(Object.getPrototypeOf(u),{getProp:{value:function(t){return this[t]},enumerable:!0},setProp:{value:function(t,e){if(t<0||t>this.length)throw new SyntaxError("Entity is out of range.");if(!this.guard(e))throw new TypeError("Property is not correct type.");return this[t]=e,this},enumerable:!0},arrayType:{value:o,enumerable:!0},guard:{value:n,enumerable:!0},initial:{value:r,enumerable:!0},isTypedArray:{value:f,enumerable:!0},name:{value:e,enumerable:!0},prefill:{value:i,enumerable:!0},[mc]:{value:!0,enumerable:!0}})}function Oc(t,e){const{arrayType:r,initial:n,prefill:o}=e,i=new r(t.spec.maxEntities);return Object.setPrototypeOf(i,e),!0===o&&i.fill(n()),i.world=t,i}function Ic(t){return oc(t)&&Object.prototype.hasOwnProperty.call(t,wc)}function Rc(t,e){if(!t)throw new SyntaxError("Component instance required.");if(isNaN(e))throw new SyntaxError("Invalid or undefined entity provided.");const{id:r,name:n,schema:o,world:i}=t,{spec:a,components:u}=i;if(e<0||e>a.maxEntities)throw new Error(`Invalid entity provided: "${e}".`);const f=u[r];if(void 0===f||t!==f)throw new Error(`Component "${n}" does not exist in this world.`);if(!f.entities.has(e))throw new Error(`Entity "${e}" does not have component "${n}" to remove.`);const c=Object.keys(o);for(let t=0,r=c.length;t<r;t++){Tc(f[c[t]],e)}return f.entities.delete(e),bc(i,e,t,!0),t}function _c(t){if(isNaN(t))throw new TypeError("Array length must be a number.");const e=new Int16Array(t).fill(dc.DESTROYED),r=t-1,n=Array.from({length:t},((t,e)=>r-e));return Object.assign(e,{available:n})}function jc(t){return"number"==typeof t&&!isNaN(t)}function xc(){return 0}(0,So.exports)("Int16",(function(t){return function(e,r,n){return t(this,e,r,n)}})),(0,So.exports)("Int8",(function(t){return function(e,r,n){return t(this,e,r,n)}})),(0,So.exports)("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}})),(0,So.exports)("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}),!0),(0,So.exports)("Uint16",(function(t){return function(e,r,n){return t(this,e,r,n)}})),(0,So.exports)("Int32",(function(t){return function(e,r,n){return t(this,e,r,n)}})),(0,So.exports)("Float32",(function(t){return function(e,r,n){return t(this,e,r,n)}}));const Pc=Ac({guard:t=>!0,initial:()=>{},name:"any"}),Mc=Ac({arrayType:Int8Array,guard:jc,initial:xc,name:"i8"}),Nc=Ac({arrayType:Uint8Array,guard:jc,initial:xc,name:"ui8"}),Cc=Ac({arrayType:Uint8ClampedArray,guard:jc,initial:xc,name:"ui8c"}),Dc=Ac({arrayType:Int16Array,guard:jc,initial:xc,name:"i16"}),Uc=Ac({arrayType:Uint16Array,guard:jc,initial:xc,name:"ui16"}),Fc=Ac({arrayType:Int32Array,guard:jc,initial:xc,name:"i32"}),Yc=Ac({arrayType:Uint32Array,guard:jc,initial:xc,name:"ui32"}),kc=Ac({arrayType:BigInt64Array,guard:jc,initial:xc,name:"i64"}),Vc=Ac({arrayType:BigUint64Array,guard:jc,initial:xc,name:"ui64"}),qc=Ac({arrayType:Float32Array,guard:jc,initial:xc,name:"f32"}),Bc=Ac({arrayType:Int32Array,guard:jc,initial:xc,name:"f64"}),Lc=Ac({guard:t=>Array.isArray(t),initial:()=>[],name:"array"}),Wc=Ac({guard:t=>"boolean"==typeof t,initial:()=>!1,name:"boolean"}),$c=Ac({guard:t=>"function"==typeof t,initial:()=>()=>{},name:"function"}),zc=Ac({guard:jc,initial:xc,name:"number"}),Gc=Ac({guard:t=>oc(t),initial:()=>({}),name:"object"}),Kc=Ac({guard:t=>"string"==typeof t,initial:()=>"",name:"string"});var Qc=xr;Sr({target:"Map",proto:!0,real:!0,forced:false},{deleteAll:function(){return Qc.apply(this,arguments)}});var Zc=function(t){return Map.prototype.entries.call(t)},Xc=Ut,Hc=Br,Jc=Zc,ts=fn;Sr({target:"Map",proto:!0,real:!0,forced:false},{every:function(t){var e=Xc(this),r=Jc(e),n=Hc(t,arguments.length>1?arguments[1]:void 0,3);return!ts(r,(function(t,r,o){if(!n(r,t,e))return o()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var es=I,rs=Ut,ns=Ar,os=Br,is=Dr,as=Zc,us=fn;Sr({target:"Map",proto:!0,real:!0,forced:false},{filter:function(t){var e=rs(this),r=as(e),n=os(t,arguments.length>1?arguments[1]:void 0,3),o=new(is(e,es("Map"))),i=ns(o.set);return us(r,(function(t,r){n(r,t,e)&&i.call(o,t,r)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}});var fs=Ut,cs=Br,ss=Zc,ls=fn;Sr({target:"Map",proto:!0,real:!0,forced:false},{find:function(t){var e=fs(this),r=ss(e),n=cs(t,arguments.length>1?arguments[1]:void 0,3);return ls(r,(function(t,r,o){if(n(r,t,e))return o(r)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var ps=Ut,ys=Br,hs=Zc,ds=fn;Sr({target:"Map",proto:!0,real:!0,forced:false},{findKey:function(t){var e=ps(this),r=hs(e),n=ys(t,arguments.length>1?arguments[1]:void 0,3);return ds(r,(function(t,r,o){if(n(r,t,e))return o(t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var gs=Ut,vs=Zc,ws=function(t,e){return t===e||t!=t&&e!=e},ms=fn;Sr({target:"Map",proto:!0,real:!0,forced:false},{includes:function(t){return ms(vs(gs(this)),(function(e,r,n){if(ws(r,t))return n()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var bs=Ut,Es=Zc,Ts=fn;Sr({target:"Map",proto:!0,real:!0,forced:false},{keyOf:function(t){return Ts(Es(bs(this)),(function(e,r,n){if(r===t)return n(e)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var Ss=I,As=Ut,Os=Ar,Is=Br,Rs=Dr,_s=Zc,js=fn;Sr({target:"Map",proto:!0,real:!0,forced:false},{mapKeys:function(t){var e=As(this),r=_s(e),n=Is(t,arguments.length>1?arguments[1]:void 0,3),o=new(Rs(e,Ss("Map"))),i=Os(o.set);return js(r,(function(t,r){i.call(o,n(r,t,e),r)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}});var xs=I,Ps=Ut,Ms=Ar,Ns=Br,Cs=Dr,Ds=Zc,Us=fn;Sr({target:"Map",proto:!0,real:!0,forced:false},{mapValues:function(t){var e=Ps(this),r=Ds(e),n=Ns(t,arguments.length>1?arguments[1]:void 0,3),o=new(Cs(e,xs("Map"))),i=Ms(o.set);return Us(r,(function(t,r){i.call(o,t,n(r,t,e))}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}});var Fs=Ut,Ys=Ar,ks=fn;Sr({target:"Map",proto:!0,real:!0,forced:false},{merge:function(t){for(var e=Fs(this),r=Ys(e.set),n=arguments.length,o=0;o<n;)ks(arguments[o++],r,{that:e,AS_ENTRIES:!0});return e}});var Vs=Ut,qs=Ar,Bs=Zc,Ls=fn;Sr({target:"Map",proto:!0,real:!0,forced:false},{reduce:function(t){var e=Vs(this),r=Bs(e),n=arguments.length<2,o=n?void 0:arguments[1];if(qs(t),Ls(r,(function(r,i){n?(n=!1,o=i):o=t(o,i,r,e)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),n)throw TypeError("Reduce of empty map with no initial value");return o}});var Ws=Ut,$s=Br,zs=Zc,Gs=fn;Sr({target:"Map",proto:!0,real:!0,forced:false},{some:function(t){var e=Ws(this),r=zs(e),n=$s(t,arguments.length>1?arguments[1]:void 0,3);return Gs(r,(function(t,r,o){if(n(r,t,e))return o()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var Ks=Ut,Qs=Ar;Sr({target:"Map",proto:!0,real:!0,forced:false},{update:function(t,e){var r=Ks(this),n=arguments.length;Qs(e);var o=r.has(t);if(!o&&n<3)throw TypeError("Updating absent value");var i=o?r.get(t):Qs(n>2?arguments[2]:void 0)(t,r);return r.set(t,e(i,t,r)),r}});const Zs={maxComponents:gc,maxEntities:vc};t.addComponentToEntity=function(t,e,r){if(!t)throw new SyntaxError("Component instance required.");if(isNaN(e))throw new SyntaxError("Invalid or undefined entity provided.");const{id:n,name:o,schema:i,world:a}=t,{spec:u,components:f}=a;if(e<0||e>u.maxEntities)throw new Error(`Invalid entity provided: "${e}".`);const c=f[n];if(!c||t!==c)throw new Error(`Component "${o}" does not exist in this world.`);if(c.entities.has(e))throw new Error(`Entity "${e}" already has component "${o}".`);if(r){const t=Object.keys(i);for(let n=0,o=t.length;n<o;n++){const o=t[n];Sc(c[o],e,r[o])}}return c.entities.add(e),bc(a,e,c,!1),t},t.any=Pc,t.array=Lc,t.boolean=Wc,t.createComponent=function(t){if(!t)throw new SyntaxError("Component creation requires a specification object.");const{name:e,schema:r}=t;if(!uc(e))throw new SyntaxError("Component name is invalid.");if(!Ec(r))throw new SyntaxError("Component schema is invalid.");return{[wc]:!0,instances:[],name:e,schema:r}},t.createEntity=function(t){if(!t)throw new SyntaxError("Entity creation requires a World object.");const e=t.entities.available.pop();if(void 0!==e)return t.entities[e]=dc.EMPTY,bc(t,e),e},t.createQuery=function(t){if(!t)throw new Error("Query spec object required.");const{all:e=[],any:r=[],none:n=[]}=t;if(![...e,...r,...n].every(Ic))throw new Error("Spec arrays must contain only Components.");return{instances:[],all:[...e],any:[...r],none:[...n]}},t.createSystem=function(t){const{name:e,pre:r=ic,post:n=ic,update:o=ic}=t;if(!uc(e))throw new SyntaxError("System name is invalid.");return{instances:[],name:e,post:n,pre:r,update:o}},t.createWorld=function(t=Zs){const{maxComponents:e=gc,maxEntities:r=vc}=t;return{archetypes:new Map,components:new Array(e),entities:_c(r),id:`${Date.now().toString(36)}_${Math.random().toString(36).substr(2,9)}`,queries:new Map,spec:Object.freeze({maxComponents:e,maxEntities:r}),systems:[]}},t.defineDataStore=Ac,t.destroyEntity=function(t,e){if(!t)throw new SyntaxError("Entity destruction requires a World object.");if(isNaN(e))throw new SyntaxError("Invalid or undefined entity provided.");const{components:r,entities:n,spec:o}=t,{available:i}=n,{maxEntities:a}=o;if(e<0||e>a)throw new Error("Entity is out of range.");if(i.includes(e))return!1;for(let t=0,n=r.length;t<n;t++){const n=r[t];n&&(n.entities.has(e)&&Rc(n,e))}return bc(t,e),i.push(e),n[e]=dc.DESTROYED,!0},t.disableSystem=function(t){return t.enabled=!1,t},t.enableSystem=function(t){return t.enabled=!0,t},t.f32=qc,t.f64=Bc,t.fnc=$c,t.getDataFromStore=function(t,e){return t[e]},t.i16=Dc,t.i32=Fc,t.i64=kc,t.i8=Mc,t.initToZero=xc,t.isSystemEnabled=function(t){return t.enabled},t.isValidComponent=Ic,t.isValidName=uc,t.isValidSchema=Ec,t.number=zc,t.numberGuard=jc,t.object=Gc,t.registerComponent=function(t,e){if(!t)throw new SyntaxError("Component registration requires a World object.");if(!e)throw new SyntaxError("Component registration requires a Component object.");const{instances:r,name:n,schema:o}=e,{components:i}=t;if(n in i)throw new Error(`Component with name "${n}" is already registered.`);const a=function(t,e){for(let r=0,n=t.length;r!=n;r++)if(t[r]===e)return r;return-1}(i,void 0);if(-1===a)throw new Error("Maximum components reached.");const u=Object.create(e,{entities:{value:new Set,enumerable:!0},id:{value:a,configurable:!1,enumerable:!0,writeable:!1},world:{value:t,configurable:!1,enumerable:!0,writeable:!1}}),f=Object.entries(o);for(let e=0,r=f.length;e<r;e++){const[r,n]=f[e];if(!uc(r))throw new SyntaxError(`Property name "${String(r)}" is invalid or forbidden.`);Object.defineProperty(u,r,{value:Oc(t,n),configurable:!1,enumerable:!0,writable:!1})}return r.push(u),i[a]=u,u},t.registerSystem=function(t,e,r){const{systems:n}=t,o=function(t,e){const{queries:r}=t;if(r.has(e))return r.get(e);const n=e=>e.world===t,o=t=>t.instances.filter(n),i=e.all.flatMap(o),a=e.any.flatMap(o),u=e.none.flatMap(o),f=rc(t,...i),c=rc(t,...a),s=rc(t,...u),l={archetypes:[],components:Object.freeze([...i,...a].reduce(((t,e)=>(t[e.name]=e,t)),{})),and:f,or:c,not:s,world:t};r.set(e,l);const p=[...t.archetypes.values()];for(let t=0,e=p.length;t<e;t++){const e=p[t];cc(l,e)&&sc(l,e)}return l}(t,r);let i=!1;const a=Object.create(e,{enabled:{get:()=>i,set(t){i=t},configurable:!1,enumerable:!0},query:{value:o,configurable:!1,enumerable:!0,writeable:!1},world:{value:t,configurable:!1,enumerable:!0,writeable:!1}});return e.instances.push(a),n.push(a),a},t.removeComponentFromEntity=Rc,t.runPostSystems=function(t,e=1){const{systems:r}=t;for(let t=0,n=r.length;t<n;t++){const n=r[t];n.enabled&&n.post(hc(n.query),pc(n.query),e)}},t.runPreSystems=function(t){const{systems:e}=t;for(let t=0,r=e.length;t<r;t++){const r=e[t];r.enabled&&r.pre(hc(r.query))}},t.runUpdateSystems=function(t,e=0){const{systems:r}=t;for(let t=0,n=r.length;t<n;t++){const n=r[t];n.enabled&&n.update(hc(n.query),pc(n.query),e)}},t.setDataInStore=Sc,t.string=Kc,t.ui16=Uc,t.ui32=Yc,t.ui64=Vc,t.ui8=Nc,t.ui8c=Cc,t.unregisterComponent=function(t){if(!t)throw new SyntaxError("Component instance required.");const{id:e,name:r,world:n}=t,{components:o}=n,i=o[e];if(!i||t!==i)throw new Error(`Component "${r}" does not exist in this world.`);const a=[...i.entities];for(let t=0,e=a.length;t<e;t++)Rc(i,a[t]);return delete o[e],n},t.unregisterSystem=function(t){const{world:e}=t,{systems:r}=e,n=r.indexOf(t);return void 0===n||nc(r,n),e}}));
//# sourceMappingURL=index.min.js.map
