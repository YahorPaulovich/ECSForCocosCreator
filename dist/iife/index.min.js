/*! *****************************************************************************
 *
 * miski
 * v0.6.0
 *
 * MIT License
 * 
 * Copyright (C) 2021 Peter Hughes<https://www.phugh.es>, all rights reserved.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
***************************************************************************** */
var miski=function(t){"use strict";var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e=function(t){return t&&t.Math==Math&&t},n=e("object"==typeof globalThis&&globalThis)||e("object"==typeof window&&window)||e("object"==typeof self&&self)||e("object"==typeof r&&r)||function(){return this}()||Function("return this")(),o={},i=function(t){try{return!!t()}catch(t){return!0}},a=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),u={},f={}.propertyIsEnumerable,c=Object.getOwnPropertyDescriptor,s=c&&!f.call({1:2},1);u.f=s?function(t){var r=c(this,t);return!!r&&r.enumerable}:f;var l,p,y=function(t,r){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:r}},h={}.toString,d=function(t){return h.call(t).slice(8,-1)},v=d,g="".split,w=i((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==v(t)?g.call(t,""):Object(t)}:Object,m=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},b=w,E=m,T=function(t){return b(E(t))},S=function(t){return"object"==typeof t?null!==t:"function"==typeof t},A=n,O=function(t){return"function"==typeof t?t:void 0},I=function(t,r){return arguments.length<2?O(A[t]):A[t]&&A[t][r]},R=I("navigator","userAgent")||"",_=n,j=R,x=_.process,P=_.Deno,M=x&&x.versions||P&&P.version,N=M&&M.v8;N?p=(l=N.split("."))[0]<4?1:l[0]+l[1]:j&&(!(l=j.match(/Edge\/(\d+)/))||l[1]>=74)&&(l=j.match(/Chrome\/(\d+)/))&&(p=l[1]);var D=p&&+p,U=D,C=i,F=!!Object.getOwnPropertySymbols&&!C((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&U&&U<41})),Y=F&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,k=I,V=Y?function(t){return"symbol"==typeof t}:function(t){var r=k("Symbol");return"function"==typeof r&&Object(t)instanceof r},q=S,B={exports:{}},L=n,W=function(t,r){try{Object.defineProperty(L,t,{value:r,configurable:!0,writable:!0})}catch(e){L[t]=r}return r},$=W,z="__core-js_shared__",G=n[z]||$(z,{}),K=G;(B.exports=function(t,r){return K[t]||(K[t]=void 0!==r?r:{})})("versions",[]).push({version:"3.16.0",mode:"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"});var Q=m,Z=function(t){return Object(Q(t))},X=Z,H={}.hasOwnProperty,J=Object.hasOwn||function(t,r){return H.call(X(t),r)},tt=0,rt=Math.random(),et=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++tt+rt).toString(36)},nt=n,ot=B.exports,it=J,at=et,ut=F,ft=Y,ct=ot("wks"),st=nt.Symbol,lt=ft?st:st&&st.withoutSetter||at,pt=function(t){return it(ct,t)&&(ut||"string"==typeof ct[t])||(ut&&it(st,t)?ct[t]=st[t]:ct[t]=lt("Symbol."+t)),ct[t]},yt=S,ht=V,dt=function(t,r){var e,n;if("string"===r&&"function"==typeof(e=t.toString)&&!q(n=e.call(t)))return n;if("function"==typeof(e=t.valueOf)&&!q(n=e.call(t)))return n;if("string"!==r&&"function"==typeof(e=t.toString)&&!q(n=e.call(t)))return n;throw TypeError("Can't convert object to primitive value")},vt=pt("toPrimitive"),gt=function(t,r){if(!yt(t)||ht(t))return t;var e,n=t[vt];if(void 0!==n){if(void 0===r&&(r="default"),e=n.call(t,r),!yt(e)||ht(e))return e;throw TypeError("Can't convert object to primitive value")}return void 0===r&&(r="number"),dt(t,r)},wt=V,mt=function(t){var r=gt(t,"string");return wt(r)?r:String(r)},bt=S,Et=n.document,Tt=bt(Et)&&bt(Et.createElement),St=function(t){return Tt?Et.createElement(t):{}},At=St,Ot=!a&&!i((function(){return 7!=Object.defineProperty(At("div"),"a",{get:function(){return 7}}).a})),It=a,Rt=u,_t=y,jt=T,xt=mt,Pt=J,Mt=Ot,Nt=Object.getOwnPropertyDescriptor;o.f=It?Nt:function(t,r){if(t=jt(t),r=xt(r),Mt)try{return Nt(t,r)}catch(t){}if(Pt(t,r))return _t(!Rt.f.call(t,r),t[r])};var Dt={},Ut=S,Ct=function(t){if(!Ut(t))throw TypeError(String(t)+" is not an object");return t},Ft=a,Yt=Ot,kt=Ct,Vt=mt,qt=Object.defineProperty;Dt.f=Ft?qt:function(t,r,e){if(kt(t),r=Vt(r),kt(e),Yt)try{return qt(t,r,e)}catch(t){}if("get"in e||"set"in e)throw TypeError("Accessors not supported");return"value"in e&&(t[r]=e.value),t};var Bt=Dt,Lt=y,Wt=a?function(t,r,e){return Bt.f(t,r,Lt(1,e))}:function(t,r,e){return t[r]=e,t},$t={exports:{}},zt=G,Gt=Function.toString;"function"!=typeof zt.inspectSource&&(zt.inspectSource=function(t){return Gt.call(t)});var Kt,Qt,Zt,Xt=zt.inspectSource,Ht=Xt,Jt=n.WeakMap,tr="function"==typeof Jt&&/native code/.test(Ht(Jt)),rr=B.exports,er=et,nr=rr("keys"),or=function(t){return nr[t]||(nr[t]=er(t))},ir={},ar=tr,ur=S,fr=Wt,cr=J,sr=G,lr=or,pr=ir,yr="Object already initialized",hr=n.WeakMap;if(ar||sr.state){var dr=sr.state||(sr.state=new hr),vr=dr.get,gr=dr.has,wr=dr.set;Kt=function(t,r){if(gr.call(dr,t))throw new TypeError(yr);return r.facade=t,wr.call(dr,t,r),r},Qt=function(t){return vr.call(dr,t)||{}},Zt=function(t){return gr.call(dr,t)}}else{var mr=lr("state");pr[mr]=!0,Kt=function(t,r){if(cr(t,mr))throw new TypeError(yr);return r.facade=t,fr(t,mr,r),r},Qt=function(t){return cr(t,mr)?t[mr]:{}},Zt=function(t){return cr(t,mr)}}var br={set:Kt,get:Qt,has:Zt,enforce:function(t){return Zt(t)?Qt(t):Kt(t,{})},getterFor:function(t){return function(r){var e;if(!ur(r)||(e=Qt(r)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return e}}},Er=n,Tr=Wt,Sr=J,Ar=W,Or=Xt,Ir=br.get,Rr=br.enforce,_r=String(String).split("String");($t.exports=function(t,r,e,n){var o,i=!!n&&!!n.unsafe,a=!!n&&!!n.enumerable,u=!!n&&!!n.noTargetGet;"function"==typeof e&&("string"!=typeof r||Sr(e,"name")||Tr(e,"name",r),(o=Rr(e)).source||(o.source=_r.join("string"==typeof r?r:""))),t!==Er?(i?!u&&t[r]&&(a=!0):delete t[r],a?t[r]=e:Tr(t,r,e)):a?t[r]=e:Ar(r,e)})(Function.prototype,"toString",(function(){return"function"==typeof this&&Ir(this).source||Or(this)}));var jr={},xr=Math.ceil,Pr=Math.floor,Mr=function(t){return isNaN(t=+t)?0:(t>0?Pr:xr)(t)},Nr=Mr,Dr=Math.min,Ur=function(t){return t>0?Dr(Nr(t),9007199254740991):0},Cr=Mr,Fr=Math.max,Yr=Math.min,kr=function(t,r){var e=Cr(t);return e<0?Fr(e+r,0):Yr(e,r)},Vr=T,qr=Ur,Br=kr,Lr=function(t){return function(r,e,n){var o,i=Vr(r),a=qr(i.length),u=Br(n,a);if(t&&e!=e){for(;a>u;)if((o=i[u++])!=o)return!0}else for(;a>u;u++)if((t||u in i)&&i[u]===e)return t||u||0;return!t&&-1}},Wr={includes:Lr(!0),indexOf:Lr(!1)},$r=J,zr=T,Gr=Wr.indexOf,Kr=ir,Qr=function(t,r){var e,n=zr(t),o=0,i=[];for(e in n)!$r(Kr,e)&&$r(n,e)&&i.push(e);for(;r.length>o;)$r(n,e=r[o++])&&(~Gr(i,e)||i.push(e));return i},Zr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Xr=Qr,Hr=Zr.concat("length","prototype");jr.f=Object.getOwnPropertyNames||function(t){return Xr(t,Hr)};var Jr={};Jr.f=Object.getOwnPropertySymbols;var te=jr,re=Jr,ee=Ct,ne=I("Reflect","ownKeys")||function(t){var r=te.f(ee(t)),e=re.f;return e?r.concat(e(t)):r},oe=J,ie=ne,ae=o,ue=Dt,fe=i,ce=/#|\.prototype\./,se=function(t,r){var e=pe[le(t)];return e==he||e!=ye&&("function"==typeof r?fe(r):!!r)},le=se.normalize=function(t){return String(t).replace(ce,".").toLowerCase()},pe=se.data={},ye=se.NATIVE="N",he=se.POLYFILL="P",de=se,ve=n,ge=o.f,we=Wt,me=$t.exports,be=W,Ee=function(t,r){for(var e=ie(r),n=ue.f,o=ae.f,i=0;i<e.length;i++){var a=e[i];oe(t,a)||n(t,a,o(r,a))}},Te=de,Se=function(t,r){var e,n,o,i,a,u=t.target,f=t.global,c=t.stat;if(e=f?ve:c?ve[u]||be(u,{}):(ve[u]||{}).prototype)for(n in r){if(i=r[n],o=t.noTargetGet?(a=ge(e,n))&&a.value:e[n],!Te(f?n:u+(c?".":"#")+n,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;Ee(i,o)}(t.sham||o&&o.sham)&&we(i,"sham",!0),me(e,n,i,t)}},Ae=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t},Oe=Ct,Ie=Ae,Re=function(){for(var t=Oe(this),r=Ie(t.add),e=0,n=arguments.length;e<n;e++)r.call(t,arguments[e]);return t};Se({target:"Set",proto:!0,real:!0,forced:false},{addAll:function(){return Re.apply(this,arguments)}});var _e=Ct,je=Ae,xe=function(){for(var t,r=_e(this),e=je(r.delete),n=!0,o=0,i=arguments.length;o<i;o++)t=e.call(r,arguments[o]),n=n&&t;return!!n},Pe=xe;Se({target:"Set",proto:!0,real:!0,forced:false},{deleteAll:function(){return Pe.apply(this,arguments)}});var Me=Ct,Ne=Ae,De=pt("species"),Ue=function(t,r){var e,n=Me(t).constructor;return void 0===n||null==(e=Me(n)[De])?r:Ne(e)},Ce={},Fe=Ce,Ye=pt("iterator"),ke=Array.prototype,Ve=function(t){return void 0!==t&&(Fe.Array===t||ke[Ye]===t)},qe=Ae,Be=function(t,r,e){if(qe(t),void 0===r)return t;switch(e){case 0:return function(){return t.call(r)};case 1:return function(e){return t.call(r,e)};case 2:return function(e,n){return t.call(r,e,n)};case 3:return function(e,n,o){return t.call(r,e,n,o)}}return function(){return t.apply(r,arguments)}},Le={};Le[pt("toStringTag")]="z";var We="[object z]"===String(Le),$e=d,ze=pt("toStringTag"),Ge="Arguments"==$e(function(){return arguments}()),Ke=We?$e:function(t){var r,e,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(e=function(t,r){try{return t[r]}catch(t){}}(r=Object(t),ze))?e:Ge?$e(r):"Object"==(n=$e(r))&&"function"==typeof r.callee?"Arguments":n},Qe=Ke,Ze=Ce,Xe=pt("iterator"),He=function(t){if(null!=t)return t[Xe]||t["@@iterator"]||Ze[Qe(t)]},Je=Ct,tn=Ct,rn=Ve,en=Ur,nn=Be,on=He,an=function(t){var r=t.return;if(void 0!==r)return Je(r.call(t)).value},un=function(t,r){this.stopped=t,this.result=r},fn=function(t,r,e){var n,o,i,a,u,f,c,s=e&&e.that,l=!(!e||!e.AS_ENTRIES),p=!(!e||!e.IS_ITERATOR),y=!(!e||!e.INTERRUPTED),h=nn(r,s,1+l+y),d=function(t){return n&&an(n),new un(!0,t)},v=function(t){return l?(tn(t),y?h(t[0],t[1],d):h(t[0],t[1])):y?h(t,d):h(t)};if(p)n=t;else{if("function"!=typeof(o=on(t)))throw TypeError("Target is not iterable");if(rn(o)){for(i=0,a=en(t.length);a>i;i++)if((u=v(t[i]))&&u instanceof un)return u;return new un(!1)}n=o.call(t)}for(f=n.next;!(c=f.call(n)).done;){try{u=v(c.value)}catch(t){throw an(n),t}if("object"==typeof u&&u&&u instanceof un)return u}return new un(!1)},cn=I,sn=Ct,ln=Ae,pn=Ue,yn=fn;Se({target:"Set",proto:!0,real:!0,forced:false},{difference:function(t){var r=sn(this),e=new(pn(r,cn("Set")))(r),n=ln(e.delete);return yn(t,(function(t){n.call(e,t)})),e}});var hn=function(t){return Set.prototype.values.call(t)},dn=Ct,vn=Be,gn=hn,wn=fn;Se({target:"Set",proto:!0,real:!0,forced:false},{every:function(t){var r=dn(this),e=gn(r),n=vn(t,arguments.length>1?arguments[1]:void 0,3);return!wn(e,(function(t,e){if(!n(t,t,r))return e()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var mn=I,bn=Ct,En=Ae,Tn=Be,Sn=Ue,An=hn,On=fn;Se({target:"Set",proto:!0,real:!0,forced:false},{filter:function(t){var r=bn(this),e=An(r),n=Tn(t,arguments.length>1?arguments[1]:void 0,3),o=new(Sn(r,mn("Set"))),i=En(o.add);return On(e,(function(t){n(t,t,r)&&i.call(o,t)}),{IS_ITERATOR:!0}),o}});var In=Ct,Rn=Be,_n=hn,jn=fn;Se({target:"Set",proto:!0,real:!0,forced:false},{find:function(t){var r=In(this),e=_n(r),n=Rn(t,arguments.length>1?arguments[1]:void 0,3);return jn(e,(function(t,e){if(n(t,t,r))return e(t)}),{IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var xn=I,Pn=Ct,Mn=Ae,Nn=Ue,Dn=fn;Se({target:"Set",proto:!0,real:!0,forced:false},{intersection:function(t){var r=Pn(this),e=new(Nn(r,xn("Set"))),n=Mn(r.has),o=Mn(e.add);return Dn(t,(function(t){n.call(r,t)&&o.call(e,t)})),e}});var Un=Ct,Cn=Ae,Fn=fn;Se({target:"Set",proto:!0,real:!0,forced:false},{isDisjointFrom:function(t){var r=Un(this),e=Cn(r.has);return!Fn(t,(function(t,n){if(!0===e.call(r,t))return n()}),{INTERRUPTED:!0}).stopped}});var Yn=Ct,kn=He,Vn=I,qn=Ct,Bn=Ae,Ln=function(t){var r=kn(t);if("function"!=typeof r)throw TypeError(String(t)+" is not iterable");return Yn(r.call(t))},Wn=fn;Se({target:"Set",proto:!0,real:!0,forced:false},{isSubsetOf:function(t){var r=Ln(this),e=qn(t),n=e.has;return"function"!=typeof n&&(e=new(Vn("Set"))(t),n=Bn(e.has)),!Wn(r,(function(t,r){if(!1===n.call(e,t))return r()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var $n=Ct,zn=Ae,Gn=fn;Se({target:"Set",proto:!0,real:!0,forced:false},{isSupersetOf:function(t){var r=$n(this),e=zn(r.has);return!Gn(t,(function(t,n){if(!1===e.call(r,t))return n()}),{INTERRUPTED:!0}).stopped}});var Kn=Ct,Qn=hn,Zn=fn;Se({target:"Set",proto:!0,real:!0,forced:false},{join:function(t){var r=Kn(this),e=Qn(r),n=void 0===t?",":String(t),o=[];return Zn(e,o.push,{that:o,IS_ITERATOR:!0}),o.join(n)}});var Xn=I,Hn=Ct,Jn=Ae,to=Be,ro=Ue,eo=hn,no=fn;Se({target:"Set",proto:!0,real:!0,forced:false},{map:function(t){var r=Hn(this),e=eo(r),n=to(t,arguments.length>1?arguments[1]:void 0,3),o=new(ro(r,Xn("Set"))),i=Jn(o.add);return no(e,(function(t){i.call(o,n(t,t,r))}),{IS_ITERATOR:!0}),o}});var oo=Ct,io=Ae,ao=hn,uo=fn;Se({target:"Set",proto:!0,real:!0,forced:false},{reduce:function(t){var r=oo(this),e=ao(r),n=arguments.length<2,o=n?void 0:arguments[1];if(io(t),uo(e,(function(e){n?(n=!1,o=e):o=t(o,e,e,r)}),{IS_ITERATOR:!0}),n)throw TypeError("Reduce of empty set with no initial value");return o}});var fo=Ct,co=Be,so=hn,lo=fn;Se({target:"Set",proto:!0,real:!0,forced:false},{some:function(t){var r=fo(this),e=so(r),n=co(t,arguments.length>1?arguments[1]:void 0,3);return lo(e,(function(t,e){if(n(t,t,r))return e()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var po=I,yo=Ct,ho=Ae,vo=Ue,go=fn;Se({target:"Set",proto:!0,real:!0,forced:false},{symmetricDifference:function(t){var r=yo(this),e=new(vo(r,po("Set")))(r),n=ho(e.delete),o=ho(e.add);return go(t,(function(t){n.call(e,t)||o.call(e,t)})),e}});var wo=I,mo=Ct,bo=Ae,Eo=Ue,To=fn;Se({target:"Set",proto:!0,real:!0,forced:false},{union:function(t){var r=mo(this),e=new(Eo(r,wo("Set")))(r);return To(t,bo(e.add),{that:e}),e}});var So={exports:{}},Ao=pt("iterator"),Oo=!1;try{var Io=0,Ro={next:function(){return{done:!!Io++}},return:function(){Oo=!0}};Ro[Ao]=function(){return this},Array.from(Ro,(function(){throw 2}))}catch(t){}var _o,jo,xo,Po="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Mo=!i((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),No=J,Do=Z,Uo=Mo,Co=or("IE_PROTO"),Fo=Object.prototype,Yo=Uo?Object.getPrototypeOf:function(t){return t=Do(t),No(t,Co)?t[Co]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Fo:null},ko=S,Vo=Ct,qo=function(t){if(!ko(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t},Bo=Object.setPrototypeOf||("__proto__"in{}?function(){var t,r=!1,e={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(e,[]),r=e instanceof Array}catch(t){}return function(e,n){return Vo(e),qo(n),r?t.call(e,n):e.__proto__=n,e}}():void 0),Lo=Po,Wo=a,$o=n,zo=S,Go=J,Ko=Ke,Qo=Wt,Zo=$t.exports,Xo=Dt.f,Ho=Yo,Jo=Bo,ti=pt,ri=et,ei=$o.Int8Array,ni=ei&&ei.prototype,oi=$o.Uint8ClampedArray,ii=oi&&oi.prototype,ai=ei&&Ho(ei),ui=ni&&Ho(ni),fi=Object.prototype,ci=fi.isPrototypeOf,si=ti("toStringTag"),li=ri("TYPED_ARRAY_TAG"),pi=ri("TYPED_ARRAY_CONSTRUCTOR"),yi=Lo&&!!Jo&&"Opera"!==Ko($o.opera),hi=!1,di={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},vi={BigInt64Array:8,BigUint64Array:8},gi=function(t){if(!zo(t))return!1;var r=Ko(t);return Go(di,r)||Go(vi,r)};for(_o in di)(xo=(jo=$o[_o])&&jo.prototype)?Qo(xo,pi,jo):yi=!1;for(_o in vi)(xo=(jo=$o[_o])&&jo.prototype)&&Qo(xo,pi,jo);if((!yi||"function"!=typeof ai||ai===Function.prototype)&&(ai=function(){throw TypeError("Incorrect invocation")},yi))for(_o in di)$o[_o]&&Jo($o[_o],ai);if((!yi||!ui||ui===fi)&&(ui=ai.prototype,yi))for(_o in di)$o[_o]&&Jo($o[_o].prototype,ui);if(yi&&Ho(ii)!==ui&&Jo(ii,ui),Wo&&!Go(ui,si))for(_o in hi=!0,Xo(ui,si,{get:function(){return zo(this)?this[li]:void 0}}),di)$o[_o]&&Qo($o[_o],li,_o);var wi={NATIVE_ARRAY_BUFFER_VIEWS:yi,TYPED_ARRAY_CONSTRUCTOR:pi,TYPED_ARRAY_TAG:hi&&li,aTypedArray:function(t){if(gi(t))return t;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(t){if(Jo&&!ci.call(ai,t))throw TypeError("Target is not a typed array constructor");return t},exportTypedArrayMethod:function(t,r,e){if(Wo){if(e)for(var n in di){var o=$o[n];if(o&&Go(o.prototype,t))try{delete o.prototype[t]}catch(t){}}ui[t]&&!e||Zo(ui,t,e?r:yi&&ni[t]||r)}},exportTypedArrayStaticMethod:function(t,r,e){var n,o;if(Wo){if(Jo){if(e)for(n in di)if((o=$o[n])&&Go(o,t))try{delete o[t]}catch(t){}if(ai[t]&&!e)return;try{return Zo(ai,t,e?r:yi&&ai[t]||r)}catch(t){}}for(n in di)!(o=$o[n])||o[t]&&!e||Zo(o,t,r)}},isView:function(t){if(!zo(t))return!1;var r=Ko(t);return"DataView"===r||Go(di,r)||Go(vi,r)},isTypedArray:gi,TypedArray:ai,TypedArrayPrototype:ui},mi=n,bi=i,Ei=function(t,r){if(!r&&!Oo)return!1;var e=!1;try{var n={};n[Ao]=function(){return{next:function(){return{done:e=!0}}}},t(n)}catch(t){}return e},Ti=wi.NATIVE_ARRAY_BUFFER_VIEWS,Si=mi.ArrayBuffer,Ai=mi.Int8Array,Oi=!Ti||!bi((function(){Ai(1)}))||!bi((function(){new Ai(-1)}))||!Ei((function(t){new Ai,new Ai(null),new Ai(1.5),new Ai(t)}),!0)||bi((function(){return 1!==new Ai(new Si(2),1,void 0).length})),Ii=$t.exports,Ri=function(t,r,e){if(!(t instanceof r))throw TypeError("Incorrect "+(e?e+" ":"")+"invocation");return t},_i=Mr,ji=Ur,xi=function(t){if(void 0===t)return 0;var r=_i(t),e=ji(r);if(r!==e)throw RangeError("Wrong length or index");return e},Pi=Math.abs,Mi=Math.pow,Ni=Math.floor,Di=Math.log,Ui=Math.LN2,Ci={pack:function(t,r,e){var n,o,i,a=new Array(e),u=8*e-r-1,f=(1<<u)-1,c=f>>1,s=23===r?Mi(2,-24)-Mi(2,-77):0,l=t<0||0===t&&1/t<0?1:0,p=0;for((t=Pi(t))!=t||t===1/0?(o=t!=t?1:0,n=f):(n=Ni(Di(t)/Ui),t*(i=Mi(2,-n))<1&&(n--,i*=2),(t+=n+c>=1?s/i:s*Mi(2,1-c))*i>=2&&(n++,i/=2),n+c>=f?(o=0,n=f):n+c>=1?(o=(t*i-1)*Mi(2,r),n+=c):(o=t*Mi(2,c-1)*Mi(2,r),n=0));r>=8;a[p++]=255&o,o/=256,r-=8);for(n=n<<r|o,u+=r;u>0;a[p++]=255&n,n/=256,u-=8);return a[--p]|=128*l,a},unpack:function(t,r){var e,n=t.length,o=8*n-r-1,i=(1<<o)-1,a=i>>1,u=o-7,f=n-1,c=t[f--],s=127&c;for(c>>=7;u>0;s=256*s+t[f],f--,u-=8);for(e=s&(1<<-u)-1,s>>=-u,u+=r;u>0;e=256*e+t[f],f--,u-=8);if(0===s)s=1-a;else{if(s===i)return e?NaN:c?-1/0:1/0;e+=Mi(2,r),s-=a}return(c?-1:1)*e*Mi(2,s-r)}},Fi=Z,Yi=kr,ki=Ur,Vi=Dt.f,qi=J,Bi=pt("toStringTag"),Li=n,Wi=a,$i=Po,zi=Wt,Gi=function(t,r,e){for(var n in r)Ii(t,n,r[n],e);return t},Ki=i,Qi=Ri,Zi=Mr,Xi=Ur,Hi=xi,Ji=Ci,ta=Yo,ra=Bo,ea=jr.f,na=Dt.f,oa=function(t){for(var r=Fi(this),e=ki(r.length),n=arguments.length,o=Yi(n>1?arguments[1]:void 0,e),i=n>2?arguments[2]:void 0,a=void 0===i?e:Yi(i,e);a>o;)r[o++]=t;return r},ia=function(t,r,e){t&&!qi(t=e?t:t.prototype,Bi)&&Vi(t,Bi,{configurable:!0,value:r})},aa=br.get,ua=br.set,fa="ArrayBuffer",ca="DataView",sa="Wrong index",la=Li.ArrayBuffer,pa=la,ya=Li.DataView,ha=ya&&ya.prototype,da=Object.prototype,va=Li.RangeError,ga=Ji.pack,wa=Ji.unpack,ma=function(t){return[255&t]},ba=function(t){return[255&t,t>>8&255]},Ea=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},Ta=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},Sa=function(t){return ga(t,23,4)},Aa=function(t){return ga(t,52,8)},Oa=function(t,r){na(t.prototype,r,{get:function(){return aa(this)[r]}})},Ia=function(t,r,e,n){var o=Hi(e),i=aa(t);if(o+r>i.byteLength)throw va(sa);var a=aa(i.buffer).bytes,u=o+i.byteOffset,f=a.slice(u,u+r);return n?f:f.reverse()},Ra=function(t,r,e,n,o,i){var a=Hi(e),u=aa(t);if(a+r>u.byteLength)throw va(sa);for(var f=aa(u.buffer).bytes,c=a+u.byteOffset,s=n(+o),l=0;l<r;l++)f[c+l]=s[i?l:r-l-1]};if($i){if(!Ki((function(){la(1)}))||!Ki((function(){new la(-1)}))||Ki((function(){return new la,new la(1.5),new la(NaN),la.name!=fa}))){for(var _a,ja=(pa=function(t){return Qi(this,pa),new la(Hi(t))}).prototype=la.prototype,xa=ea(la),Pa=0;xa.length>Pa;)(_a=xa[Pa++])in pa||zi(pa,_a,la[_a]);ja.constructor=pa}ra&&ta(ha)!==da&&ra(ha,da);var Ma=new ya(new pa(2)),Na=ha.setInt8;Ma.setInt8(0,2147483648),Ma.setInt8(1,2147483649),!Ma.getInt8(0)&&Ma.getInt8(1)||Gi(ha,{setInt8:function(t,r){Na.call(this,t,r<<24>>24)},setUint8:function(t,r){Na.call(this,t,r<<24>>24)}},{unsafe:!0})}else pa=function(t){Qi(this,pa,fa);var r=Hi(t);ua(this,{bytes:oa.call(new Array(r),0),byteLength:r}),Wi||(this.byteLength=r)},ya=function(t,r,e){Qi(this,ya,ca),Qi(t,pa,ca);var n=aa(t).byteLength,o=Zi(r);if(o<0||o>n)throw va("Wrong offset");if(o+(e=void 0===e?n-o:Xi(e))>n)throw va("Wrong length");ua(this,{buffer:t,byteLength:e,byteOffset:o}),Wi||(this.buffer=t,this.byteLength=e,this.byteOffset=o)},Wi&&(Oa(pa,"byteLength"),Oa(ya,"buffer"),Oa(ya,"byteLength"),Oa(ya,"byteOffset")),Gi(ya.prototype,{getInt8:function(t){return Ia(this,1,t)[0]<<24>>24},getUint8:function(t){return Ia(this,1,t)[0]},getInt16:function(t){var r=Ia(this,2,t,arguments.length>1?arguments[1]:void 0);return(r[1]<<8|r[0])<<16>>16},getUint16:function(t){var r=Ia(this,2,t,arguments.length>1?arguments[1]:void 0);return r[1]<<8|r[0]},getInt32:function(t){return Ta(Ia(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return Ta(Ia(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return wa(Ia(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return wa(Ia(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,r){Ra(this,1,t,ma,r)},setUint8:function(t,r){Ra(this,1,t,ma,r)},setInt16:function(t,r){Ra(this,2,t,ba,r,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,r){Ra(this,2,t,ba,r,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,r){Ra(this,4,t,Ea,r,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,r){Ra(this,4,t,Ea,r,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,r){Ra(this,4,t,Sa,r,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,r){Ra(this,8,t,Aa,r,arguments.length>2?arguments[2]:void 0)}});ia(pa,fa),ia(ya,ca);var Da,Ua={ArrayBuffer:pa,DataView:ya},Ca=S,Fa=Math.floor,Ya=Mr,ka=function(t){var r=Ya(t);if(r<0)throw RangeError("The argument can't be less than 0");return r},Va=Qr,qa=Zr,Ba=Object.keys||function(t){return Va(t,qa)},La=Dt,Wa=Ct,$a=Ba,za=a?Object.defineProperties:function(t,r){Wa(t);for(var e,n=$a(r),o=n.length,i=0;o>i;)La.f(t,e=n[i++],r[e]);return t},Ga=I("document","documentElement"),Ka=Ct,Qa=za,Za=Zr,Xa=ir,Ha=Ga,Ja=St,tu=or("IE_PROTO"),ru=function(){},eu=function(t){return"<script>"+t+"</"+"script>"},nu=function(t){t.write(eu("")),t.close();var r=t.parentWindow.Object;return t=null,r},ou=function(){try{Da=new ActiveXObject("htmlfile")}catch(t){}ou=document.domain&&Da?nu(Da):function(){var t,r=Ja("iframe");if(r.style)return r.style.display="none",Ha.appendChild(r),r.src=String("javascript:"),(t=r.contentWindow.document).open(),t.write(eu("document.F=Object")),t.close(),t.F}()||nu(Da);for(var t=Za.length;t--;)delete ou.prototype[Za[t]];return ou()};Xa[tu]=!0;var iu=Object.create||function(t,r){var e;return null!==t?(ru.prototype=Ka(t),e=new ru,ru.prototype=null,e[tu]=t):e=ou(),void 0===r?e:Qa(e,r)},au=Z,uu=Ur,fu=He,cu=Ve,su=Be,lu=wi.aTypedArrayConstructor,pu=d,yu=Array.isArray||function(t){return"Array"==pu(t)},hu=S,du=yu,vu=pt("species"),gu=function(t){var r;return du(t)&&("function"!=typeof(r=t.constructor)||r!==Array&&!du(r.prototype)?hu(r)&&null===(r=r[vu])&&(r=void 0):r=void 0),void 0===r?Array:r},wu=Be,mu=w,bu=Z,Eu=Ur,Tu=function(t,r){return new(gu(t))(0===r?0:r)},Su=[].push,Au=function(t){var r=1==t,e=2==t,n=3==t,o=4==t,i=6==t,a=7==t,u=5==t||i;return function(f,c,s,l){for(var p,y,h=bu(f),d=mu(h),v=wu(c,s,3),g=Eu(d.length),w=0,m=l||Tu,b=r?m(f,g):e||a?m(f,0):void 0;g>w;w++)if((u||w in d)&&(y=v(p=d[w],w,h),t))if(r)b[w]=y;else if(y)switch(t){case 3:return!0;case 5:return p;case 6:return w;case 2:Su.call(b,p)}else switch(t){case 4:return!1;case 7:Su.call(b,p)}return i?-1:n||o?o:b}},Ou={forEach:Au(0),map:Au(1),filter:Au(2),some:Au(3),every:Au(4),find:Au(5),findIndex:Au(6),filterReject:Au(7)},Iu=I,Ru=Dt,_u=a,ju=pt("species"),xu=S,Pu=Bo,Mu=Se,Nu=n,Du=a,Uu=Oi,Cu=wi,Fu=Ua,Yu=Ri,ku=y,Vu=Wt,qu=function(t){return!Ca(t)&&isFinite(t)&&Fa(t)===t},Bu=Ur,Lu=xi,Wu=function(t,r){var e=ka(t);if(e%r)throw RangeError("Wrong offset");return e},$u=mt,zu=J,Gu=Ke,Ku=S,Qu=V,Zu=iu,Xu=Bo,Hu=jr.f,Ju=function(t){var r,e,n,o,i,a,u=au(t),f=arguments.length,c=f>1?arguments[1]:void 0,s=void 0!==c,l=fu(u);if(null!=l&&!cu(l))for(a=(i=l.call(u)).next,u=[];!(o=a.call(i)).done;)u.push(o.value);for(s&&f>2&&(c=su(c,arguments[2],2)),e=uu(u.length),n=new(lu(this))(e),r=0;e>r;r++)n[r]=s?c(u[r],r):u[r];return n},tf=Ou.forEach,rf=function(t){var r=Iu(t),e=Ru.f;_u&&r&&!r[ju]&&e(r,ju,{configurable:!0,get:function(){return this}})},ef=Dt,nf=o,of=function(t,r,e){var n,o;return Pu&&"function"==typeof(n=r.constructor)&&n!==e&&xu(o=n.prototype)&&o!==e.prototype&&Pu(t,o),t},af=br.get,uf=br.set,ff=ef.f,cf=nf.f,sf=Math.round,lf=Nu.RangeError,pf=Fu.ArrayBuffer,yf=Fu.DataView,hf=Cu.NATIVE_ARRAY_BUFFER_VIEWS,df=Cu.TYPED_ARRAY_CONSTRUCTOR,vf=Cu.TYPED_ARRAY_TAG,gf=Cu.TypedArray,wf=Cu.TypedArrayPrototype,mf=Cu.aTypedArrayConstructor,bf=Cu.isTypedArray,Ef="BYTES_PER_ELEMENT",Tf="Wrong length",Sf=function(t,r){for(var e=0,n=r.length,o=new(mf(t))(n);n>e;)o[e]=r[e++];return o},Af=function(t,r){ff(t,r,{get:function(){return af(this)[r]}})},Of=function(t){var r;return t instanceof pf||"ArrayBuffer"==(r=Gu(t))||"SharedArrayBuffer"==r},If=function(t,r){return bf(t)&&!Qu(r)&&r in t&&qu(+r)&&r>=0},Rf=function(t,r){return r=$u(r),If(t,r)?ku(2,t[r]):cf(t,r)},_f=function(t,r,e){return r=$u(r),!(If(t,r)&&Ku(e)&&zu(e,"value"))||zu(e,"get")||zu(e,"set")||e.configurable||zu(e,"writable")&&!e.writable||zu(e,"enumerable")&&!e.enumerable?ff(t,r,e):(t[r]=e.value,t)};Du?(hf||(nf.f=Rf,ef.f=_f,Af(wf,"buffer"),Af(wf,"byteOffset"),Af(wf,"byteLength"),Af(wf,"length")),Mu({target:"Object",stat:!0,forced:!hf},{getOwnPropertyDescriptor:Rf,defineProperty:_f}),So.exports=function(t,r,e){var n=t.match(/\d+$/)[0]/8,o=t+(e?"Clamped":"")+"Array",i="get"+t,a="set"+t,u=Nu[o],f=u,c=f&&f.prototype,s={},l=function(t,r){ff(t,r,{get:function(){return function(t,r){var e=af(t);return e.view[i](r*n+e.byteOffset,!0)}(this,r)},set:function(t){return function(t,r,o){var i=af(t);e&&(o=(o=sf(o))<0?0:o>255?255:255&o),i.view[a](r*n+i.byteOffset,o,!0)}(this,r,t)},enumerable:!0})};hf?Uu&&(f=r((function(t,r,e,i){return Yu(t,f,o),of(Ku(r)?Of(r)?void 0!==i?new u(r,Wu(e,n),i):void 0!==e?new u(r,Wu(e,n)):new u(r):bf(r)?Sf(f,r):Ju.call(f,r):new u(Lu(r)),t,f)})),Xu&&Xu(f,gf),tf(Hu(u),(function(t){t in f||Vu(f,t,u[t])})),f.prototype=c):(f=r((function(t,r,e,i){Yu(t,f,o);var a,u,c,s=0,p=0;if(Ku(r)){if(!Of(r))return bf(r)?Sf(f,r):Ju.call(f,r);a=r,p=Wu(e,n);var y=r.byteLength;if(void 0===i){if(y%n)throw lf(Tf);if((u=y-p)<0)throw lf(Tf)}else if((u=Bu(i)*n)+p>y)throw lf(Tf);c=u/n}else c=Lu(r),a=new pf(u=c*n);for(uf(t,{buffer:a,byteOffset:p,byteLength:u,length:c,view:new yf(a)});s<c;)l(t,s++)})),Xu&&Xu(f,gf),c=f.prototype=Zu(wf)),c.constructor!==f&&Vu(c,"constructor",f),Vu(c,df,f),vf&&Vu(c,vf,o),s[o]=f,Mu({global:!0,forced:f!=u,sham:!hf},s),Ef in f||Vu(f,Ef,n),Ef in c||Vu(c,Ef,n),rf(o)}):So.exports=function(){},(0,So.exports)("Uint32",(function(t){return function(r,e,n){return t(this,r,e,n)}}));var jf=Math.floor,xf=function(t,r){var e=t.length,n=jf(e/2);return e<8?Pf(t,r):Mf(xf(t.slice(0,n),r),xf(t.slice(n),r),r)},Pf=function(t,r){for(var e,n,o=t.length,i=1;i<o;){for(n=i,e=t[i];n&&r(t[n-1],e)>0;)t[n]=t[--n];n!==i++&&(t[n]=e)}return t},Mf=function(t,r,e){for(var n=t.length,o=r.length,i=0,a=0,u=[];i<n||a<o;)i<n&&a<o?u.push(e(t[i],r[a])<=0?t[i++]:r[a++]):u.push(i<n?t[i++]:r[a++]);return u},Nf=xf,Df=R.match(/firefox\/(\d+)/i),Uf=!!Df&&+Df[1],Cf=/MSIE|Trident/.test(R),Ff=R.match(/AppleWebKit\/(\d+)\./),Yf=!!Ff&&+Ff[1],kf=i,Vf=Ae,qf=Ur,Bf=Nf,Lf=Uf,Wf=Cf,$f=D,zf=Yf,Gf=wi.aTypedArray,Kf=wi.exportTypedArrayMethod,Qf=n.Uint16Array,Zf=Qf&&Qf.prototype.sort,Xf=!!Zf&&!kf((function(){var t=new Qf(2);t.sort(null),t.sort({})})),Hf=!!Zf&&!kf((function(){if($f)return $f<74;if(Lf)return Lf<67;if(Wf)return!0;if(zf)return zf<602;var t,r,e=new Qf(516),n=Array(516);for(t=0;t<516;t++)r=t%4,e[t]=515-t,n[t]=t-2*r+3;for(e.sort((function(t,r){return(t/4|0)-(r/4|0)})),t=0;t<516;t++)if(e[t]!==n[t])return!0}));function Jf(t){return 32*t.length}function tc(t,r){if(!function(t,r){return!(r<0||r>Jf(t))}(t,r))throw new SyntaxError(`Bit ${r} does not exist on mask.`);return t[Math.floor(r/32)]|=1<<r%32,t}function rc(t){const r=Jf(t);let e=0;for(let n=0,o=t.length;n<o;n++)e+=(t[n]^r)+n%32;return parseInt(Math.abs(e).toString(8),8)}function ec(t,...r){const e=function(t=32){return new Uint32Array(Math.ceil(t/32))}(t.spec.maxComponents||32);if(!r.length)return e;for(let n=0,o=r.length;n<o;n++){const o=r[n];if(o.world.id!==t.id)throw new Error("Components are not from the same world.");tc(e,o.id)}return e}function nc(t,r){const e=t.length;if(!e)return t;for(;r<e;)t[r]=t[r+1],r++;return t.length=t.length-1,t}function oc(t){return Boolean("object"==typeof t&&!Array.isArray(t))}function ic(t){}Kf("sort",(function(t){var r=this;if(void 0!==t&&Vf(t),Hf)return Zf.call(r,t);Gf(r);var e,n=qf(r.length),o=Array(n);for(e=0;e<n;e++)o[e]=r[e];for(o=Bf(r,function(t){return function(r,e){return void 0!==t?+t(r,e)||0:e!=e?-1:r!=r?1:0===r&&0===e?1/r>0&&1/e<0?1:-1:r>e}}(t)),e=0;e<n;e++)r[e]=o[e];return r}),!Hf||Xf);const ac=/^(?![0-9])[a-zA-Z0-9$_]+$/;function uc(t){return"string"==typeof t&&((t=t.trim()).length>0&&ac.test(t)&&!fc.has(t))}const fc=new Set(["entities","id","instances","name","schema","world","constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","prototype","toLocaleString","toString","valueOf","__defineGetter__","__defineSetter__","__lookupGetter__","__lookupGetter__","__proto__"]);function cc(t,r){for(let e=0,n=t.and.length;e<n;e++){const n=r.mask[e];if(0!=(t.not[e]&n))return!1;if((t.and[e]&n)!==t.and[e])return!1;if((t.or[e]&n)>0)return!1}return!0}function sc(t,r){return-1!==t.archetypes.indexOf(r)||t.archetypes.push(r),t}function lc(t,r){const e=t.archetypes.indexOf(r);return-1===e||nc(t.archetypes,e),t}function pc(t){return t.components}function yc(t){return[...t.entities]}function hc(t){return t.archetypes.flatMap(yc)}var dc;!function(t){t[t.EMPTY=-1]="EMPTY",t[t.DESTROYED=-2]="DESTROYED"}(dc||(dc={}));const vc=128,gc=1e4,wc=Symbol(),mc=Symbol();function bc(t,r,e,n=!1){const{archetypes:o,entities:i}=t;let a=[];const u=i[r];if(void 0===u||u<-1)throw new Error("Entity is not available!");if(u>-1){const e=o.get(u);e&&(a=[...e.components],e.entities.delete(r),0===e.entities.size&&function(t,r){const{archetypes:e,queries:n}=t,{id:o}=r;if(e.get(o)!==r)throw new Error("Archetype not found in world.");const i=[...n.values()];for(let t=0,e=i.length;t<e;t++)lc(i[t],r);e.delete(o)}(t,e))}if(e)if(!1===n)a.push(e);else{const t=a.indexOf(e);t>-1&&nc(a,t)}if(0===a.length)return i[r]=dc.EMPTY,null;const f=function(t,...r){const e=ec(t,...r);return{components:new Set(r),entities:new Set,mask:e,id:rc(e)}}(t,...a),{id:c}=f,s=o.get(c);if(void 0===s){const e=[...t.queries.values()];for(let t=0,r=e.length;t<r;t++){const r=e[t];cc(r,f)&&sc(r,f)}return i[r]=c,f.entities.add(r),o.set(c,f),f}return i[r]=s.id,s.entities.add(r),s}function Ec(t){if(!t)return!1;if(!oc(t))return!1;if(Object.hasOwnProperty.call(t,"schema")&&!oc(t=t.schema))return!1;const r=Object.values(t);return 0!==r.length&&r.every((t=>!0===t[mc]))}function Tc(t,r){const{initial:e,isTypedArray:n,prefill:o}=t;if(r<0||r>t.length)throw new SyntaxError("Entity is out of range.");try{delete t[r]}catch(e){if(!n)throw new Error(e);t[r]=0}return!0===o&&(t[r]=e()),t}function Sc(t,r,e){if(r<0||r>t.length)throw new SyntaxError("Entity is out of range.");if(!t.guard(e))throw new TypeError("Value is not correct type.");return t[r]=e,t}function Ac(t){const{name:r,initial:e,guard:n,arrayType:o=Array,prefill:i=!1}=t;if(!r||!n)throw new SyntaxError("Invalid datastore spec - mandatory properties missing.");if(!uc(r))throw new Error("Invalid name.");const a=e();if(!n(a))throw new TypeError("Initial property is of invalid type. Make sure guard(initial()) returns true.");const u=new o,f=function(t){return Boolean(ArrayBuffer.isView(t)&&!(t instanceof DataView))}(u);if(f&&("number"!=typeof a||isNaN(a)))throw new TypeError(`Initial property for typed array type must be a number. Found ${typeof a}.`);return Object.create(Object.getPrototypeOf(u),{getProp:{value:function(t){return this[t]},enumerable:!0},setProp:{value:function(t,r){if(t<0||t>this.length)throw new SyntaxError("Entity is out of range.");if(!this.guard(r))throw new TypeError("Property is not correct type.");return this[t]=r,this},enumerable:!0},arrayType:{value:o,enumerable:!0},guard:{value:n,enumerable:!0},initial:{value:e,enumerable:!0},isTypedArray:{value:f,enumerable:!0},name:{value:r,enumerable:!0},prefill:{value:i,enumerable:!0},[mc]:{value:!0,enumerable:!0}})}function Oc(t,r){const{arrayType:e,initial:n,prefill:o}=r,i=new e(t.spec.maxEntities);return Object.setPrototypeOf(i,r),!0===o&&i.fill(n()),i.world=t,i}function Ic(t){return oc(t)&&Object.prototype.hasOwnProperty.call(t,wc)}function Rc(t,r){if(!t)throw new SyntaxError("Component instance required.");if(isNaN(r))throw new SyntaxError("Invalid or undefined entity provided.");const{id:e,name:n,schema:o,world:i}=t,{spec:a,components:u}=i;if(r<0||r>a.maxEntities)throw new Error(`Invalid entity provided: "${r}".`);const f=u[e];if(void 0===f||t!==f)throw new Error(`Component "${n}" does not exist in this world.`);if(!f.entities.has(r))throw new Error(`Entity "${r}" does not have component "${n}" to remove.`);const c=Object.keys(o);for(let t=0,e=c.length;t<e;t++){Tc(f[c[t]],r)}return f.entities.delete(r),bc(i,r,t,!0),t}function _c(t){if(isNaN(t))throw new TypeError("Array length must be a number.");const r=new Int16Array(t).fill(dc.DESTROYED),e=t-1,n=Array.from({length:t},((t,r)=>e-r));return Object.assign(r,{available:n})}function jc(t){return"number"==typeof t&&!isNaN(t)}function xc(){return 0}(0,So.exports)("Int16",(function(t){return function(r,e,n){return t(this,r,e,n)}})),(0,So.exports)("Int8",(function(t){return function(r,e,n){return t(this,r,e,n)}})),(0,So.exports)("Uint8",(function(t){return function(r,e,n){return t(this,r,e,n)}})),(0,So.exports)("Uint8",(function(t){return function(r,e,n){return t(this,r,e,n)}}),!0),(0,So.exports)("Uint16",(function(t){return function(r,e,n){return t(this,r,e,n)}})),(0,So.exports)("Int32",(function(t){return function(r,e,n){return t(this,r,e,n)}})),(0,So.exports)("Float32",(function(t){return function(r,e,n){return t(this,r,e,n)}}));const Pc=Ac({guard:t=>!0,initial:()=>{},name:"any"}),Mc=Ac({arrayType:Int8Array,guard:jc,initial:xc,name:"i8"}),Nc=Ac({arrayType:Uint8Array,guard:jc,initial:xc,name:"ui8"}),Dc=Ac({arrayType:Uint8ClampedArray,guard:jc,initial:xc,name:"ui8c"}),Uc=Ac({arrayType:Int16Array,guard:jc,initial:xc,name:"i16"}),Cc=Ac({arrayType:Uint16Array,guard:jc,initial:xc,name:"ui16"}),Fc=Ac({arrayType:Int32Array,guard:jc,initial:xc,name:"i32"}),Yc=Ac({arrayType:Uint32Array,guard:jc,initial:xc,name:"ui32"}),kc=Ac({arrayType:BigInt64Array,guard:jc,initial:xc,name:"i64"}),Vc=Ac({arrayType:BigUint64Array,guard:jc,initial:xc,name:"ui64"}),qc=Ac({arrayType:Float32Array,guard:jc,initial:xc,name:"f32"}),Bc=Ac({arrayType:Int32Array,guard:jc,initial:xc,name:"f64"}),Lc=Ac({guard:t=>Array.isArray(t),initial:()=>[],name:"array"}),Wc=Ac({guard:t=>"boolean"==typeof t,initial:()=>!1,name:"boolean"}),$c=Ac({guard:t=>"function"==typeof t,initial:()=>()=>{},name:"function"}),zc=Ac({guard:jc,initial:xc,name:"number"}),Gc=Ac({guard:t=>oc(t),initial:()=>({}),name:"object"}),Kc=Ac({guard:t=>"string"==typeof t,initial:()=>"",name:"string"});var Qc=xe;Se({target:"Map",proto:!0,real:!0,forced:false},{deleteAll:function(){return Qc.apply(this,arguments)}});var Zc=function(t){return Map.prototype.entries.call(t)},Xc=Ct,Hc=Be,Jc=Zc,ts=fn;Se({target:"Map",proto:!0,real:!0,forced:false},{every:function(t){var r=Xc(this),e=Jc(r),n=Hc(t,arguments.length>1?arguments[1]:void 0,3);return!ts(e,(function(t,e,o){if(!n(e,t,r))return o()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var rs=I,es=Ct,ns=Ae,os=Be,is=Ue,as=Zc,us=fn;Se({target:"Map",proto:!0,real:!0,forced:false},{filter:function(t){var r=es(this),e=as(r),n=os(t,arguments.length>1?arguments[1]:void 0,3),o=new(is(r,rs("Map"))),i=ns(o.set);return us(e,(function(t,e){n(e,t,r)&&i.call(o,t,e)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}});var fs=Ct,cs=Be,ss=Zc,ls=fn;Se({target:"Map",proto:!0,real:!0,forced:false},{find:function(t){var r=fs(this),e=ss(r),n=cs(t,arguments.length>1?arguments[1]:void 0,3);return ls(e,(function(t,e,o){if(n(e,t,r))return o(e)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var ps=Ct,ys=Be,hs=Zc,ds=fn;Se({target:"Map",proto:!0,real:!0,forced:false},{findKey:function(t){var r=ps(this),e=hs(r),n=ys(t,arguments.length>1?arguments[1]:void 0,3);return ds(e,(function(t,e,o){if(n(e,t,r))return o(t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var vs=Ct,gs=Zc,ws=function(t,r){return t===r||t!=t&&r!=r},ms=fn;Se({target:"Map",proto:!0,real:!0,forced:false},{includes:function(t){return ms(gs(vs(this)),(function(r,e,n){if(ws(e,t))return n()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var bs=Ct,Es=Zc,Ts=fn;Se({target:"Map",proto:!0,real:!0,forced:false},{keyOf:function(t){return Ts(Es(bs(this)),(function(r,e,n){if(e===t)return n(r)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var Ss=I,As=Ct,Os=Ae,Is=Be,Rs=Ue,_s=Zc,js=fn;Se({target:"Map",proto:!0,real:!0,forced:false},{mapKeys:function(t){var r=As(this),e=_s(r),n=Is(t,arguments.length>1?arguments[1]:void 0,3),o=new(Rs(r,Ss("Map"))),i=Os(o.set);return js(e,(function(t,e){i.call(o,n(e,t,r),e)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}});var xs=I,Ps=Ct,Ms=Ae,Ns=Be,Ds=Ue,Us=Zc,Cs=fn;Se({target:"Map",proto:!0,real:!0,forced:false},{mapValues:function(t){var r=Ps(this),e=Us(r),n=Ns(t,arguments.length>1?arguments[1]:void 0,3),o=new(Ds(r,xs("Map"))),i=Ms(o.set);return Cs(e,(function(t,e){i.call(o,t,n(e,t,r))}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}});var Fs=Ct,Ys=Ae,ks=fn;Se({target:"Map",proto:!0,real:!0,forced:false},{merge:function(t){for(var r=Fs(this),e=Ys(r.set),n=arguments.length,o=0;o<n;)ks(arguments[o++],e,{that:r,AS_ENTRIES:!0});return r}});var Vs=Ct,qs=Ae,Bs=Zc,Ls=fn;Se({target:"Map",proto:!0,real:!0,forced:false},{reduce:function(t){var r=Vs(this),e=Bs(r),n=arguments.length<2,o=n?void 0:arguments[1];if(qs(t),Ls(e,(function(e,i){n?(n=!1,o=i):o=t(o,i,e,r)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),n)throw TypeError("Reduce of empty map with no initial value");return o}});var Ws=Ct,$s=Be,zs=Zc,Gs=fn;Se({target:"Map",proto:!0,real:!0,forced:false},{some:function(t){var r=Ws(this),e=zs(r),n=$s(t,arguments.length>1?arguments[1]:void 0,3);return Gs(e,(function(t,e,o){if(n(e,t,r))return o()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var Ks=Ct,Qs=Ae;Se({target:"Map",proto:!0,real:!0,forced:false},{update:function(t,r){var e=Ks(this),n=arguments.length;Qs(r);var o=e.has(t);if(!o&&n<3)throw TypeError("Updating absent value");var i=o?e.get(t):Qs(n>2?arguments[2]:void 0)(t,e);return e.set(t,r(i,t,e)),e}});const Zs={maxComponents:vc,maxEntities:gc};return t.addComponentToEntity=function(t,r,e){if(!t)throw new SyntaxError("Component instance required.");if(isNaN(r))throw new SyntaxError("Invalid or undefined entity provided.");const{id:n,name:o,schema:i,world:a}=t,{spec:u,components:f}=a;if(r<0||r>u.maxEntities)throw new Error(`Invalid entity provided: "${r}".`);const c=f[n];if(!c||t!==c)throw new Error(`Component "${o}" does not exist in this world.`);if(c.entities.has(r))throw new Error(`Entity "${r}" already has component "${o}".`);if(e){const t=Object.keys(i);for(let n=0,o=t.length;n<o;n++){const o=t[n];Sc(c[o],r,e[o])}}return c.entities.add(r),bc(a,r,c,!1),t},t.any=Pc,t.array=Lc,t.boolean=Wc,t.createComponent=function(t){if(!t)throw new SyntaxError("Component creation requires a specification object.");const{name:r,schema:e}=t;if(!uc(r))throw new SyntaxError("Component name is invalid.");if(!Ec(e))throw new SyntaxError("Component schema is invalid.");return{[wc]:!0,instances:[],name:r,schema:e}},t.createEntity=function(t){if(!t)throw new SyntaxError("Entity creation requires a World object.");const r=t.entities.available.pop();if(void 0!==r)return t.entities[r]=dc.EMPTY,bc(t,r),r},t.createQuery=function(t){if(!t)throw new Error("Query spec object required.");const{all:r=[],any:e=[],none:n=[]}=t;if(![...r,...e,...n].every(Ic))throw new Error("Spec arrays must contain only Components.");return{instances:[],all:[...r],any:[...e],none:[...n]}},t.createSystem=function(t){const{name:r,pre:e=ic,post:n=ic,update:o=ic}=t;if(!uc(r))throw new SyntaxError("System name is invalid.");return{instances:[],name:r,post:n,pre:e,update:o}},t.createWorld=function(t=Zs){const{maxComponents:r=vc,maxEntities:e=gc}=t;return{archetypes:new Map,components:new Array(r),entities:_c(e),id:`${Date.now().toString(36)}_${Math.random().toString(36).substr(2,9)}`,queries:new Map,spec:Object.freeze({maxComponents:r,maxEntities:e}),systems:[]}},t.defineDataStore=Ac,t.destroyEntity=function(t,r){if(!t)throw new SyntaxError("Entity destruction requires a World object.");if(isNaN(r))throw new SyntaxError("Invalid or undefined entity provided.");const{components:e,entities:n,spec:o}=t,{available:i}=n,{maxEntities:a}=o;if(r<0||r>a)throw new Error("Entity is out of range.");if(i.includes(r))return!1;for(let t=0,n=e.length;t<n;t++){const n=e[t];n&&(n.entities.has(r)&&Rc(n,r))}return bc(t,r),i.push(r),n[r]=dc.DESTROYED,!0},t.disableSystem=function(t){return t.enabled=!1,t},t.enableSystem=function(t){return t.enabled=!0,t},t.f32=qc,t.f64=Bc,t.fnc=$c,t.getDataFromStore=function(t,r){return t[r]},t.i16=Uc,t.i32=Fc,t.i64=kc,t.i8=Mc,t.initToZero=xc,t.isSystemEnabled=function(t){return t.enabled},t.isValidComponent=Ic,t.isValidName=uc,t.isValidSchema=Ec,t.number=zc,t.numberGuard=jc,t.object=Gc,t.registerComponent=function(t,r){if(!t)throw new SyntaxError("Component registration requires a World object.");if(!r)throw new SyntaxError("Component registration requires a Component object.");const{instances:e,name:n,schema:o}=r,{components:i}=t;if(n in i)throw new Error(`Component with name "${n}" is already registered.`);const a=function(t,r){for(let e=0,n=t.length;e!=n;e++)if(t[e]===r)return e;return-1}(i,void 0);if(-1===a)throw new Error("Maximum components reached.");const u=Object.create(r,{entities:{value:new Set,enumerable:!0},id:{value:a,configurable:!1,enumerable:!0,writeable:!1},world:{value:t,configurable:!1,enumerable:!0,writeable:!1}}),f=Object.entries(o);for(let r=0,e=f.length;r<e;r++){const[e,n]=f[r];if(!uc(e))throw new SyntaxError(`Property name "${String(e)}" is invalid or forbidden.`);Object.defineProperty(u,e,{value:Oc(t,n),configurable:!1,enumerable:!0,writable:!1})}return e.push(u),i[a]=u,u},t.registerSystem=function(t,r,e){const{systems:n}=t,o=function(t,r){const{queries:e}=t;if(e.has(r))return e.get(r);const n=r=>r.world===t,o=t=>t.instances.filter(n),i=r.all.flatMap(o),a=r.any.flatMap(o),u=r.none.flatMap(o),f=ec(t,...i),c=ec(t,...a),s=ec(t,...u),l={archetypes:[],components:Object.freeze([...i,...a].reduce(((t,r)=>(t[r.name]=r,t)),{})),and:f,or:c,not:s,world:t};e.set(r,l);const p=[...t.archetypes.values()];for(let t=0,r=p.length;t<r;t++){const r=p[t];cc(l,r)&&sc(l,r)}return l}(t,e);let i=!1;const a=Object.create(r,{enabled:{get:()=>i,set(t){i=t},configurable:!1,enumerable:!0},query:{value:o,configurable:!1,enumerable:!0,writeable:!1},world:{value:t,configurable:!1,enumerable:!0,writeable:!1}});return r.instances.push(a),n.push(a),a},t.removeComponentFromEntity=Rc,t.runPostSystems=function(t,r=1){const{systems:e}=t;for(let t=0,n=e.length;t<n;t++){const n=e[t];n.enabled&&n.post(hc(n.query),pc(n.query),r)}},t.runPreSystems=function(t){const{systems:r}=t;for(let t=0,e=r.length;t<e;t++){const e=r[t];e.enabled&&e.pre(hc(e.query))}},t.runUpdateSystems=function(t,r=0){const{systems:e}=t;for(let t=0,n=e.length;t<n;t++){const n=e[t];n.enabled&&n.update(hc(n.query),pc(n.query),r)}},t.setDataInStore=Sc,t.string=Kc,t.ui16=Cc,t.ui32=Yc,t.ui64=Vc,t.ui8=Nc,t.ui8c=Dc,t.unregisterComponent=function(t){if(!t)throw new SyntaxError("Component instance required.");const{id:r,name:e,world:n}=t,{components:o}=n,i=o[r];if(!i||t!==i)throw new Error(`Component "${e}" does not exist in this world.`);const a=[...i.entities];for(let t=0,r=a.length;t<r;t++)Rc(i,a[t]);return delete o[r],n},t.unregisterSystem=function(t){const{world:r}=t,{systems:e}=r,n=e.indexOf(t);return void 0===n||nc(e,n),r},t}({});
//# sourceMappingURL=index.min.js.map
