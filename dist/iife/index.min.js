/*! *****************************************************************************
 *
 * miski
 * v0.1.4
 *
 * MIT License
 * 
 * Copyright (C) 2021 Peter Hughes<https://www.phugh.es>, all rights reserved.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
***************************************************************************** */
var miski=function(t){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(t){var e={exports:{}};return t(e,e.exports),e.exports}var check=function(t){return t&&t.Math==Math&&t},n=check("object"==typeof globalThis&&globalThis)||check("object"==typeof window&&window)||check("object"==typeof self&&self)||check("object"==typeof e&&e)||function(){return this}()||Function("return this")(),fails=function(t){try{return!!t()}catch(t){return!0}},r=!fails((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),o={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,u={f:i&&!o.call({1:2},1)?function propertyIsEnumerable(t){var e=i(this,t);return!!e&&e.enumerable}:o},createPropertyDescriptor=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},c={}.toString,classofRaw=function(t){return c.call(t).slice(8,-1)},a="".split,f=fails((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==classofRaw(t)?a.call(t,""):Object(t)}:Object,requireObjectCoercible=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},toIndexedObject=function(t){return f(requireObjectCoercible(t))},isObject=function(t){return"object"==typeof t?null!==t:"function"==typeof t},toPrimitive=function(t,e){if(!isObject(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!isObject(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!isObject(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!isObject(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},l={}.hasOwnProperty,has=function(t,e){return l.call(t,e)},s=n.document,p=isObject(s)&&isObject(s.createElement),d=!r&&!fails((function(){return 7!=Object.defineProperty((t="div",p?s.createElement(t):{}),"a",{get:function(){return 7}}).a;var t})),h=Object.getOwnPropertyDescriptor,g={f:r?h:function getOwnPropertyDescriptor(t,e){if(t=toIndexedObject(t),e=toPrimitive(e,!0),d)try{return h(t,e)}catch(t){}if(has(t,e))return createPropertyDescriptor(!u.f.call(t,e),t[e])}},anObject=function(t){if(!isObject(t))throw TypeError(String(t)+" is not an object");return t},y=Object.defineProperty,m={f:r?y:function defineProperty(t,e,n){if(anObject(t),e=toPrimitive(e,!0),anObject(n),d)try{return y(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},v=r?function(t,e,n){return m.f(t,e,createPropertyDescriptor(1,n))}:function(t,e,n){return t[e]=n,t},setGlobal=function(t,e){try{v(n,t,e)}catch(r){n[t]=e}return e},S="__core-js_shared__",E=n[S]||setGlobal(S,{}),T=Function.toString;"function"!=typeof E.inspectSource&&(E.inspectSource=function(t){return T.call(t)});var b,w,R,I,O=E.inspectSource,A=n.WeakMap,_="function"==typeof A&&/native code/.test(O(A)),j=!1,M=createCommonjsModule((function(t){(t.exports=function(t,e){return E[t]||(E[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.8.1",mode:"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})})),P=0,N=Math.random(),uid=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++P+N).toString(36)},C=M("keys"),D={},k=n.WeakMap;if(_){var x=E.state||(E.state=new k),z=x.get,U=x.has,B=x.set;b=function(t,e){return e.facade=t,B.call(x,t,e),e},w=function(t){return z.call(x,t)||{}},R=function(t){return U.call(x,t)}}else{var F=C[I="state"]||(C[I]=uid(I));D[F]=!0,b=function(t,e){return e.facade=t,v(t,F,e),e},w=function(t){return has(t,F)?t[F]:{}},R=function(t){return has(t,F)}}var L={set:b,get:w,has:R,enforce:function(t){return R(t)?w(t):b(t,{})},getterFor:function(t){return function(e){var n;if(!isObject(e)||(n=w(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}},$=createCommonjsModule((function(t){var e=L.get,r=L.enforce,o=String(String).split("String");(t.exports=function(t,e,i,u){var c,a=!!u&&!!u.unsafe,f=!!u&&!!u.enumerable,l=!!u&&!!u.noTargetGet;"function"==typeof i&&("string"!=typeof e||has(i,"name")||v(i,"name",e),(c=r(i)).source||(c.source=o.join("string"==typeof e?e:""))),t!==n?(a?!l&&t[e]&&(f=!0):delete t[e],f?t[e]=i:v(t,e,i)):f?t[e]=i:setGlobal(e,i)})(Function.prototype,"toString",(function toString(){return"function"==typeof this&&e(this).source||O(this)}))})),K=n,aFunction=function(t){return"function"==typeof t?t:void 0},getBuiltIn=function(t,e){return arguments.length<2?aFunction(K[t])||aFunction(n[t]):K[t]&&K[t][e]||n[t]&&n[t][e]},W=Math.ceil,V=Math.floor,toInteger=function(t){return isNaN(t=+t)?0:(t>0?V:W)(t)},G=Math.min,toLength=function(t){return t>0?G(toInteger(t),9007199254740991):0},q=Math.max,Y=Math.min,createMethod=function(t){return function(e,n,r){var o,i=toIndexedObject(e),u=toLength(i.length),c=function(t,e){var n=toInteger(t);return n<0?q(n+e,0):Y(n,e)}(r,u);if(t&&n!=n){for(;u>c;)if((o=i[c++])!=o)return!0}else for(;u>c;c++)if((t||c in i)&&i[c]===n)return t||c||0;return!t&&-1}},H={includes:createMethod(!0),indexOf:createMethod(!1)}.indexOf,J=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"].concat("length","prototype"),Q={f:Object.getOwnPropertyNames||function getOwnPropertyNames(t){return function(t,e){var n,r=toIndexedObject(t),o=0,i=[];for(n in r)!has(D,n)&&has(r,n)&&i.push(n);for(;e.length>o;)has(r,n=e[o++])&&(~H(i,n)||i.push(n));return i}(t,J)}},X={f:Object.getOwnPropertySymbols},Z=getBuiltIn("Reflect","ownKeys")||function ownKeys(t){var e=Q.f(anObject(t)),n=X.f;return n?e.concat(n(t)):e},copyConstructorProperties=function(t,e){for(var n=Z(e),r=m.f,o=g.f,i=0;i<n.length;i++){var u=n[i];has(t,u)||r(t,u,o(e,u))}},tt=/#|\.prototype\./,isForced=function(t,e){var n=nt[et(t)];return n==ot||n!=rt&&("function"==typeof e?fails(e):!!e)},et=isForced.normalize=function(t){return String(t).replace(tt,".").toLowerCase()},nt=isForced.data={},rt=isForced.NATIVE="N",ot=isForced.POLYFILL="P",it=isForced,ut=g.f,_export=function(t,e){var r,o,i,u,c,a=t.target,f=t.global,l=t.stat;if(r=f?n:l?n[a]||setGlobal(a,{}):(n[a]||{}).prototype)for(o in e){if(u=e[o],i=t.noTargetGet?(c=ut(r,o))&&c.value:r[o],!it(f?o:a+(l?".":"#")+o,t.forced)&&void 0!==i){if(typeof u==typeof i)continue;copyConstructorProperties(u,i)}(t.sham||i&&i.sham)&&v(u,"sham",!0),$(r,o,u,t)}},aFunction$1=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t},collectionDeleteAll=function(){for(var t,e=anObject(this),n=aFunction$1(e.delete),r=!0,o=0,i=arguments.length;o<i;o++)t=n.call(e,arguments[o]),r=r&&t;return!!r};_export({target:"Map",proto:!0,real:!0,forced:j},{deleteAll:function deleteAll(){return collectionDeleteAll.apply(this,arguments)}});var functionBindContext=function(t,e,n){if(aFunction$1(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}},ct=!!Object.getOwnPropertySymbols&&!fails((function(){return!String(Symbol())})),at=ct&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ft=M("wks"),lt=n.Symbol,st=at?lt:lt&&lt.withoutSetter||uid,wellKnownSymbol=function(t){return has(ft,t)||(ct&&has(lt,t)?ft[t]=lt[t]:ft[t]=st("Symbol."+t)),ft[t]},pt={};pt[wellKnownSymbol("toStringTag")]="z";var dt="[object z]"===String(pt),ht=wellKnownSymbol("toStringTag"),gt="Arguments"==classofRaw(function(){return arguments}()),yt=dt?classofRaw:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),ht))?n:gt?classofRaw(e):"Object"==(r=classofRaw(e))&&"function"==typeof e.callee?"Arguments":r},mt={},vt=wellKnownSymbol("iterator"),getIteratorMethod=function(t){if(null!=t)return t[vt]||t["@@iterator"]||mt[yt(t)]},getMapIterator=function(t){return Map.prototype.entries.call(t)},St=wellKnownSymbol("iterator"),Et=Array.prototype,iteratorClose=function(t){var e=t.return;if(void 0!==e)return anObject(e.call(t)).value},Result=function(t,e){this.stopped=t,this.result=e},iterate=function(t,e,n){var r,o,i,u,c,a,f,l,s=n&&n.that,p=!(!n||!n.AS_ENTRIES),d=!(!n||!n.IS_ITERATOR),h=!(!n||!n.INTERRUPTED),g=functionBindContext(e,s,1+p+h),stop=function(t){return r&&iteratorClose(r),new Result(!0,t)},callFn=function(t){return p?(anObject(t),h?g(t[0],t[1],stop):g(t[0],t[1])):h?g(t,stop):g(t)};if(d)r=t;else{if("function"!=typeof(o=getIteratorMethod(t)))throw TypeError("Target is not iterable");if(void 0!==(l=o)&&(mt.Array===l||Et[St]===l)){for(i=0,u=toLength(t.length);u>i;i++)if((c=callFn(t[i]))&&c instanceof Result)return c;return new Result(!1)}r=o.call(t)}for(a=r.next;!(f=a.call(r)).done;){try{c=callFn(f.value)}catch(t){throw iteratorClose(r),t}if("object"==typeof c&&c&&c instanceof Result)return c}return new Result(!1)};_export({target:"Map",proto:!0,real:!0,forced:j},{every:function every(t){var e=anObject(this),n=getMapIterator(e),r=functionBindContext(t,arguments.length>1?arguments[1]:void 0,3);return!iterate(n,(function(t,n,o){if(!r(n,t,e))return o()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var Tt=wellKnownSymbol("species"),speciesConstructor=function(t,e){var n,r=anObject(t).constructor;return void 0===r||null==(n=anObject(r)[Tt])?e:aFunction$1(n)};_export({target:"Map",proto:!0,real:!0,forced:j},{filter:function filter(t){var e=anObject(this),n=getMapIterator(e),r=functionBindContext(t,arguments.length>1?arguments[1]:void 0,3),o=new(speciesConstructor(e,getBuiltIn("Map"))),i=aFunction$1(o.set);return iterate(n,(function(t,n){r(n,t,e)&&i.call(o,t,n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}}),_export({target:"Map",proto:!0,real:!0,forced:j},{find:function find(t){var e=anObject(this),n=getMapIterator(e),r=functionBindContext(t,arguments.length>1?arguments[1]:void 0,3);return iterate(n,(function(t,n,o){if(r(n,t,e))return o(n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),_export({target:"Map",proto:!0,real:!0,forced:j},{findKey:function findKey(t){var e=anObject(this),n=getMapIterator(e),r=functionBindContext(t,arguments.length>1?arguments[1]:void 0,3);return iterate(n,(function(t,n,o){if(r(n,t,e))return o(t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});_export({target:"Map",proto:!0,real:!0,forced:j},{includes:function includes(t){return iterate(getMapIterator(anObject(this)),(function(e,n,r){if((o=n)===(i=t)||o!=o&&i!=i)return r();var o,i}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),_export({target:"Map",proto:!0,real:!0,forced:j},{keyOf:function keyOf(t){return iterate(getMapIterator(anObject(this)),(function(e,n,r){if(n===t)return r(e)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),_export({target:"Map",proto:!0,real:!0,forced:j},{mapKeys:function mapKeys(t){var e=anObject(this),n=getMapIterator(e),r=functionBindContext(t,arguments.length>1?arguments[1]:void 0,3),o=new(speciesConstructor(e,getBuiltIn("Map"))),i=aFunction$1(o.set);return iterate(n,(function(t,n){i.call(o,r(n,t,e),n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}}),_export({target:"Map",proto:!0,real:!0,forced:j},{mapValues:function mapValues(t){var e=anObject(this),n=getMapIterator(e),r=functionBindContext(t,arguments.length>1?arguments[1]:void 0,3),o=new(speciesConstructor(e,getBuiltIn("Map"))),i=aFunction$1(o.set);return iterate(n,(function(t,n){i.call(o,t,r(n,t,e))}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}}),_export({target:"Map",proto:!0,real:!0,forced:j},{merge:function merge(t){for(var e=anObject(this),n=aFunction$1(e.set),r=0;r<arguments.length;)iterate(arguments[r++],n,{that:e,AS_ENTRIES:!0});return e}}),_export({target:"Map",proto:!0,real:!0,forced:j},{reduce:function reduce(t){var e=anObject(this),n=getMapIterator(e),r=arguments.length<2,o=r?void 0:arguments[1];if(aFunction$1(t),iterate(n,(function(n,i){r?(r=!1,o=i):o=t(o,i,n,e)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),r)throw TypeError("Reduce of empty map with no initial value");return o}}),_export({target:"Map",proto:!0,real:!0,forced:j},{some:function some(t){var e=anObject(this),n=getMapIterator(e),r=functionBindContext(t,arguments.length>1?arguments[1]:void 0,3);return iterate(n,(function(t,n,o){if(r(n,t,e))return o()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),_export({target:"Map",proto:!0,real:!0,forced:j},{update:function update(t,e){var n=anObject(this),r=arguments.length;aFunction$1(e);var o=n.has(t);if(!o&&r<3)throw TypeError("Updating absent value");var i=o?n.get(t):aFunction$1(r>2?arguments[2]:void 0)(t,n);return n.set(t,e(i,t,n)),n}});var collectionAddAll=function(){for(var t=anObject(this),e=aFunction$1(t.add),n=0,r=arguments.length;n<r;n++)e.call(t,arguments[n]);return t};_export({target:"Set",proto:!0,real:!0,forced:j},{addAll:function addAll(){return collectionAddAll.apply(this,arguments)}}),_export({target:"Set",proto:!0,real:!0,forced:j},{deleteAll:function deleteAll(){return collectionDeleteAll.apply(this,arguments)}}),_export({target:"Set",proto:!0,real:!0,forced:j},{difference:function difference(t){var e=anObject(this),n=new(speciesConstructor(e,getBuiltIn("Set")))(e),r=aFunction$1(n.delete);return iterate(t,(function(t){r.call(n,t)})),n}});var getSetIterator=function(t){return Set.prototype.values.call(t)};_export({target:"Set",proto:!0,real:!0,forced:j},{every:function every(t){var e=anObject(this),n=getSetIterator(e),r=functionBindContext(t,arguments.length>1?arguments[1]:void 0,3);return!iterate(n,(function(t,n){if(!r(t,t,e))return n()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),_export({target:"Set",proto:!0,real:!0,forced:j},{filter:function filter(t){var e=anObject(this),n=getSetIterator(e),r=functionBindContext(t,arguments.length>1?arguments[1]:void 0,3),o=new(speciesConstructor(e,getBuiltIn("Set"))),i=aFunction$1(o.add);return iterate(n,(function(t){r(t,t,e)&&i.call(o,t)}),{IS_ITERATOR:!0}),o}}),_export({target:"Set",proto:!0,real:!0,forced:j},{find:function find(t){var e=anObject(this),n=getSetIterator(e),r=functionBindContext(t,arguments.length>1?arguments[1]:void 0,3);return iterate(n,(function(t,n){if(r(t,t,e))return n(t)}),{IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),_export({target:"Set",proto:!0,real:!0,forced:j},{intersection:function intersection(t){var e=anObject(this),n=new(speciesConstructor(e,getBuiltIn("Set"))),r=aFunction$1(e.has),o=aFunction$1(n.add);return iterate(t,(function(t){r.call(e,t)&&o.call(n,t)})),n}}),_export({target:"Set",proto:!0,real:!0,forced:j},{isDisjointFrom:function isDisjointFrom(t){var e=anObject(this),n=aFunction$1(e.has);return!iterate(t,(function(t,r){if(!0===n.call(e,t))return r()}),{INTERRUPTED:!0}).stopped}}),_export({target:"Set",proto:!0,real:!0,forced:j},{isSubsetOf:function isSubsetOf(t){var e=function(t){var e=getIteratorMethod(t);if("function"!=typeof e)throw TypeError(String(t)+" is not iterable");return anObject(e.call(t))}(this),n=anObject(t),r=n.has;return"function"!=typeof r&&(n=new(getBuiltIn("Set"))(t),r=aFunction$1(n.has)),!iterate(e,(function(t,e){if(!1===r.call(n,t))return e()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),_export({target:"Set",proto:!0,real:!0,forced:j},{isSupersetOf:function isSupersetOf(t){var e=anObject(this),n=aFunction$1(e.has);return!iterate(t,(function(t,r){if(!1===n.call(e,t))return r()}),{INTERRUPTED:!0}).stopped}}),_export({target:"Set",proto:!0,real:!0,forced:j},{join:function join(t){var e=anObject(this),n=getSetIterator(e),r=void 0===t?",":String(t),o=[];return iterate(n,o.push,{that:o,IS_ITERATOR:!0}),o.join(r)}}),_export({target:"Set",proto:!0,real:!0,forced:j},{map:function map(t){var e=anObject(this),n=getSetIterator(e),r=functionBindContext(t,arguments.length>1?arguments[1]:void 0,3),o=new(speciesConstructor(e,getBuiltIn("Set"))),i=aFunction$1(o.add);return iterate(n,(function(t){i.call(o,r(t,t,e))}),{IS_ITERATOR:!0}),o}}),_export({target:"Set",proto:!0,real:!0,forced:j},{reduce:function reduce(t){var e=anObject(this),n=getSetIterator(e),r=arguments.length<2,o=r?void 0:arguments[1];if(aFunction$1(t),iterate(n,(function(n){r?(r=!1,o=n):o=t(o,n,n,e)}),{IS_ITERATOR:!0}),r)throw TypeError("Reduce of empty set with no initial value");return o}}),_export({target:"Set",proto:!0,real:!0,forced:j},{some:function some(t){var e=anObject(this),n=getSetIterator(e),r=functionBindContext(t,arguments.length>1?arguments[1]:void 0,3);return iterate(n,(function(t,n){if(r(t,t,e))return n()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),_export({target:"Set",proto:!0,real:!0,forced:j},{symmetricDifference:function symmetricDifference(t){var e=anObject(this),n=new(speciesConstructor(e,getBuiltIn("Set")))(e),r=aFunction$1(n.delete),o=aFunction$1(n.add);return iterate(t,(function(t){r.call(n,t)||o.call(n,t)})),n}}),_export({target:"Set",proto:!0,real:!0,forced:j},{union:function union(t){var e=anObject(this),n=new(speciesConstructor(e,getBuiltIn("Set")))(e);return iterate(t,aFunction$1(n.add),{that:n}),n}});var bt,wt,createMethod$1=function(t){return function(e,n,r,o){aFunction$1(n);var i=Object(requireObjectCoercible(e)),u=f(i),c=toLength(i.length),a=t?c-1:0,l=t?-1:1;if(r<2)for(;;){if(a in u){o=u[a],a+=l;break}if(a+=l,t?a<0:c<=a)throw TypeError("Reduce of empty array with no initial value")}for(;t?a>=0:c>a;a+=l)a in u&&(o=n(o,u[a],a,i));return o}},Rt={left:createMethod$1(!1),right:createMethod$1(!0)},It=Object.defineProperty,Ot={},thrower=function(t){throw t},At=getBuiltIn("navigator","userAgent")||"",_t=n.process,jt=_t&&_t.versions,Mt=jt&&jt.v8;Mt?wt=(bt=Mt.split("."))[0]+bt[1]:At&&(!(bt=At.match(/Edge\/(\d+)/))||bt[1]>=74)&&(bt=At.match(/Chrome\/(\d+)/))&&(wt=bt[1]);var Pt,Nt,Ct=wt&&+wt,Dt="process"==classofRaw(n.process),kt=Rt.left,xt=!!(Nt=[]["reduce"])&&fails((function(){Nt.call(null,Pt||function(){throw 1},1)})),zt=function(t,e){if(has(Ot,t))return Ot[t];e||(e={});var n=[][t],o=!!has(e,"ACCESSORS")&&e.ACCESSORS,i=has(e,0)?e[0]:thrower,u=has(e,1)?e[1]:void 0;return Ot[t]=!!n&&!fails((function(){if(o&&!r)return!0;var t={length:-1};o?It(t,1,{enumerable:!0,get:thrower}):t[1]=1,n.call(t,i,u)}))}("reduce",{1:0});function _createComponent(t){var e;const{id:n,name:r,properties:o}={...t};let i=null!==(e=t.entityLimit)&&void 0!==e?e:null,u=void 0===t.entityLimit;!function deepAssign(t,...e){return e.forEach((e=>{const n=Object.keys(e).reduce(((t,n)=>{const r=Object.getOwnPropertyDescriptor(e,n);return void 0!==r&&(t[n]=r),t}),{});Object.getOwnPropertySymbols(e).forEach((t=>{const r=Object.getOwnPropertyDescriptor(e,t);null!=r&&r.enumerable&&(n[t]=r)})),Object.defineProperties(t,n)})),t}(o,t.properties);const c=new Set,a={get id(){return n},get name(){return r},get entities(){return Array.from(c)},get entityLimit(){return i},get properties(){return o},get removable(){return u}};return Object.freeze(Object.assign(a,{hasEntity:function(t){return c.has(t)},setEntityLimit:function(t){i=t},setRemovable:function(t){u=t},_addEntity:function(t){if(null!=i&&c.size>=i)throw new Error(`component "${r}" has reached its entity limit of ${i}.`);c.add(t)},_removeEntity:function(t){if(!u)throw new Error(`component ${r} is not removable.`);c.delete(t)}}))}function createMask(t){"number"==typeof t&&(t=BigInt(t));let{mask:e}={mask:1n<<t};const n={get value(){return e}};return Object.freeze(Object.assign(n,{has:function(t){return"number"==typeof t&&(t=BigInt(t)),Boolean((e&t)===e)},set:function(t){"number"==typeof t&&(t=BigInt(t)),e|=1n<<t},test:function(t){return"number"==typeof t&&(t=BigInt(t)),Boolean(0n!==(e&1n<<t))},toggle:function(t){"number"==typeof t&&(t=BigInt(t)),e^=1n<<t},toString:function(){return e.toString(2)},unset:function(t){"number"==typeof t&&(t=BigInt(t)),e&=~(1n<<t)}}))}function _createEntity(){const t=createMask(0n),e={},n=new Set;let r=0n,o=null;const i=Object.create({components:e},{archetype:{get:function(){return t.value}},allComponents:{get:function(){return Array.from(n)}},id:{get:function(){return r}},world:{get:function(){return o}}});return Object.freeze(Object.assign(i,{_setId:function(t){r=t},_setWorld:function(t){o=t},_addComponent:function(r){e[r.name]||(e[r.name]={...r.properties},t.set(r.id),n.add(r))},_removeComponent:function(r){e[r.name]&&(delete e[r.name],t.unset(r.id),n.delete(r))},hasComponent:function(t){const n="string"==typeof t?t:t.name;return Boolean(e[n])}}))}return _export({target:"Array",proto:!0,forced:!xt||!zt||!Dt&&Ct>79&&Ct<83},{reduce:function reduce(t){return kt(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}}),t.createWorld=function createWorld(t){const{initialPoolSize:e=10,maxComponents:n=1024n}={...t},isComponentRegistered=function(t){return o.get(t.name)===t},addEntityToArchetypeArray=function(t){var e;void 0===r.get(t.archetype)&&r.set(t.archetype,new Set),null===(e=r.get(t.archetype))||void 0===e||e.add(t)},removeEntityFromArchetypeArray=function(t){var e;null===(e=r.get(t.archetype))||void 0===e||e.delete(t)},r=new Map,o=new Map,i=new Map,u=[],c=function _createPool(t){const{initialSize:e=2,create:n,destroy:r}={...t},o=[];for(let t=0;t<e;t++)o.push(n());return Object.freeze({get:function(){var t;return null!==(t=o.pop())&&void 0!==t?t:n()},release:function(t){o.push(r(t))}})}({create:_createEntity,destroy:function(t){return t._setId(-1n),removeComponentsFromEntity(t,...t.allComponents),removeEntityFromArchetypeArray(t),t},initialSize:e});let a=0n,f=0n,l=0n,s={},p={};const d={get archetypes(){return Array.from(r.entries())},get components(){return Array.from(o.values())},get component(){return s},get entities(){return Array.from(i.values())},get entity(){return p},get systems(){return Array.from(u)}},createComponent=function(t){if(void 0!==n&&f>n)throw new Error("Maximum component count reached.");if(o.has(t.name))throw new Error(`component "${t.name}" already exists.`);const e=_createComponent({...t,id:f});return o.set(e.name,e),++f,e},addComponentsToEntity=function(t,...e){if(!t)throw new Error("no entity provided.");return null!=e&&e.length?(removeEntityFromArchetypeArray(t),e.forEach((e=>{if(!1===isComponentRegistered(e))throw new Error(`component ${e.name} is not registered in this world.`);0==e.hasEntity(t)&&(e._addEntity(t),t._addComponent(e))})),addEntityToArchetypeArray(t),t):t},removeComponentsFromEntity=function(t,...e){if(!t)throw new Error("no entity provided.");return null!=e&&e.length?(removeEntityFromArchetypeArray(t),e.forEach((e=>{if(!1===isComponentRegistered(e))throw new Error(`component ${e.name} is not registered in this world.`);1==e.hasEntity(t)&&(e._removeEntity(t),t._removeComponent(e))})),addEntityToArchetypeArray(t),t):t},removeSystem=function(t){if(null==t||!t.name)return!1;const e=u.indexOf(t);return e>-1&&(u.splice(e,1),!0)},getSystemByName=function(t){if(t)return u.find((e=>e.name===t))},h=Object.assign(d,{createEntity:function(){const t=c.get();return t._setId(a),t._setWorld(h),i.set(a,t),addEntityToArchetypeArray(t),++a,t},removeEntity:function(t){if(!t)return!1;const e=i.delete(t.id);return!0===e&&c.release(t),e},getEntityById:function(t){return i.get(t)},createComponent:createComponent,removeComponent:function(t){if(null==t||!t.name)return!1;const e=o.delete(t.name);return!0===e&&t.entities.forEach((e=>removeComponentsFromEntity(e,t))),e},getComponentByName:function(t){return o.get(t)},addComponentsToEntity:addComponentsToEntity,removeComponentsFromEntity:removeComponentsFromEntity,createSystem:function(t,e){if(getSystemByName(t.name))throw new Error(`system "${t.name}" already exists.`);{const n=function _createSystem(t){const{components:e=[],id:n,name:r,updateFn:o=(()=>{}),renderFn:i=(()=>{})}={...t},u=createMask(0n);e.forEach((t=>u.set(t.id)));let c=!1;const a={get archetype(){return u.value},get enabled(){return c},get id(){return n},get name(){return r}};return Object.freeze(Object.assign(a,{enable:function(){c=!0},disable:function(){c=!1},update:function(t,e){o(t,e)},render:function(t,e){i(t,e)}}))}({...t,id:l});return void 0!==e?u.splice(e,0,n):u.push(n),++l,n}},removeSystem:removeSystem,moveSystem:function(t,e){if(null==t||!t.id)throw new Error("no system provided.");if(void 0===e||"number"!=typeof e)throw new Error("no new index provided.");return!0===removeSystem(t)&&u.splice(e,0,t),t},getSystemByName:getSystemByName,update:function(t){const e=Array.from(r.entries()),n=e.length-1,o=[];for(let r=u.length-1;r>=0;r--){const i=u[r];if(!1!==i.enabled){for(let t=n;t>=0;t--){const[n,r]=e[t];(i.archetype&n)===i.archetype&&o.push(...r)}i.update(t,o),o.length=0}}},render:function(t){const e=Array.from(r.entries()),n=e.length-1,o=[];for(let r=u.length-1;r>=0;r--){const i=u[r];if(!1!==i.enabled){for(let t=n;t>=0;t--){const[n,r]=e[t];(i.archetype&n)===i.archetype&&o.push(...r)}i.render(t,o),o.length=0}}}});return p=h.createEntity(),s=createComponent({name:"world",entityLimit:1,removable:!1,properties:{world:h}}),addComponentsToEntity(p,s),Object.freeze(h)},t}({});
//# sourceMappingURL=index.min.js.map
