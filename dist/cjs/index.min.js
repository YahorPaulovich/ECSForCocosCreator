/*! *****************************************************************************
 *
 * miski
 * v0.3.1
 *
 * MIT License
 * 
 * Copyright (C) 2021 Peter Hughes<https://www.phugh.es>, all rights reserved.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
***************************************************************************** */
"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e=function(t){return t&&t.Math==Math&&t},r=e("object"==typeof globalThis&&globalThis)||e("object"==typeof window&&window)||e("object"==typeof self&&self)||e("object"==typeof t&&t)||function(){return this}()||Function("return this")(),n={},o=function(t){try{return!!t()}catch(t){return!0}},i=!o((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),a={},u={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,c=s&&!u.call({1:2},1);a.f=c?function(t){var e=s(this,t);return!!e&&e.enumerable}:u;var f=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},l={}.toString,h=function(t){return l.call(t).slice(8,-1)},p=h,d="".split,y=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},g=o((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==p(t)?d.call(t,""):Object(t)}:Object,m=y,v=function(t){return g(m(t))},E=function(t){return"object"==typeof t?null!==t:"function"==typeof t},S=E,w=function(t,e){if(!S(t))return t;var r,n;if(e&&"function"==typeof(r=t.toString)&&!S(n=r.call(t)))return n;if("function"==typeof(r=t.valueOf)&&!S(n=r.call(t)))return n;if(!e&&"function"==typeof(r=t.toString)&&!S(n=r.call(t)))return n;throw TypeError("Can't convert object to primitive value")},_=y,b=function(t){return Object(_(t))},T={}.hasOwnProperty,O=function(t,e){return T.call(b(t),e)},R=E,A=r.document,I=R(A)&&R(A.createElement),j=function(t){return I?A.createElement(t):{}},P=!i&&!o((function(){return 7!=Object.defineProperty(j("div"),"a",{get:function(){return 7}}).a})),x=i,N=a,M=f,D=v,C=w,z=O,k=P,$=Object.getOwnPropertyDescriptor;n.f=x?$:function(t,e){if(t=D(t),e=C(e,!0),k)try{return $(t,e)}catch(t){}if(z(t,e))return M(!N.f.call(t,e),t[e])};var U={},F=E,B=function(t){if(!F(t))throw TypeError(String(t)+" is not an object");return t},G=i,L=P,q=B,Q=w,K=Object.defineProperty;U.f=G?K:function(t,e,r){if(q(t),e=Q(e,!0),q(r),L)try{return K(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(t[e]=r.value),t};var V=U,W=f,Y=i?function(t,e,r){return V.f(t,e,W(1,r))}:function(t,e,r){return t[e]=r,t},Z={exports:{}},H=r,J=Y,X=function(t,e){try{J(H,t,e)}catch(r){H[t]=e}return e},tt=X,et=r["__core-js_shared__"]||tt("__core-js_shared__",{}),rt=et,nt=Function.toString;"function"!=typeof rt.inspectSource&&(rt.inspectSource=function(t){return nt.call(t)});var ot=rt.inspectSource,it=ot,at=r.WeakMap,ut="function"==typeof at&&/native code/.test(it(at)),st={exports:{}},ct=et;(st.exports=function(t,e){return ct[t]||(ct[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.12.1",mode:"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"});var ft,lt,ht,pt=0,dt=Math.random(),yt=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++pt+dt).toString(36)},gt=st.exports,mt=yt,vt=gt("keys"),Et={},St=ut,wt=E,_t=Y,bt=O,Tt=et,Ot=function(t){return vt[t]||(vt[t]=mt(t))},Rt=Et,At=r.WeakMap;if(St||Tt.state){var It=Tt.state||(Tt.state=new At),jt=It.get,Pt=It.has,xt=It.set;ft=function(t,e){if(Pt.call(It,t))throw new TypeError("Object already initialized");return e.facade=t,xt.call(It,t,e),e},lt=function(t){return jt.call(It,t)||{}},ht=function(t){return Pt.call(It,t)}}else{var Nt=Ot("state");Rt[Nt]=!0,ft=function(t,e){if(bt(t,Nt))throw new TypeError("Object already initialized");return e.facade=t,_t(t,Nt,e),e},lt=function(t){return bt(t,Nt)?t[Nt]:{}},ht=function(t){return bt(t,Nt)}}var Mt={set:ft,get:lt,has:ht,enforce:function(t){return ht(t)?lt(t):ft(t,{})},getterFor:function(t){return function(e){var r;if(!wt(e)||(r=lt(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return r}}},Dt=r,Ct=Y,zt=O,kt=X,$t=ot,Ut=Mt.get,Ft=Mt.enforce,Bt=String(String).split("String");(Z.exports=function(t,e,r,n){var o,i=!!n&&!!n.unsafe,a=!!n&&!!n.enumerable,u=!!n&&!!n.noTargetGet;"function"==typeof r&&("string"!=typeof e||zt(r,"name")||Ct(r,"name",e),(o=Ft(r)).source||(o.source=Bt.join("string"==typeof e?e:""))),t!==Dt?(i?!u&&t[e]&&(a=!0):delete t[e],a?t[e]=r:Ct(t,e,r)):a?t[e]=r:kt(e,r)})(Function.prototype,"toString",(function(){return"function"==typeof this&&Ut(this).source||$t(this)}));var Gt=r,Lt=r,qt=function(t){return"function"==typeof t?t:void 0},Qt=function(t,e){return arguments.length<2?qt(Gt[t])||qt(Lt[t]):Gt[t]&&Gt[t][e]||Lt[t]&&Lt[t][e]},Kt={},Vt=Math.ceil,Wt=Math.floor,Yt=function(t){return isNaN(t=+t)?0:(t>0?Wt:Vt)(t)},Zt=Yt,Ht=Math.min,Jt=function(t){return t>0?Ht(Zt(t),9007199254740991):0},Xt=Yt,te=Math.max,ee=Math.min,re=v,ne=Jt,oe=function(t,e){var r=Xt(t);return r<0?te(r+e,0):ee(r,e)},ie=function(t){return function(e,r,n){var o,i=re(e),a=ne(i.length),u=oe(n,a);if(t&&r!=r){for(;a>u;)if((o=i[u++])!=o)return!0}else for(;a>u;u++)if((t||u in i)&&i[u]===r)return t||u||0;return!t&&-1}},ae={includes:ie(!0),indexOf:ie(!1)},ue=O,se=v,ce=ae.indexOf,fe=Et,le=function(t,e){var r,n=se(t),o=0,i=[];for(r in n)!ue(fe,r)&&ue(n,r)&&i.push(r);for(;e.length>o;)ue(n,r=e[o++])&&(~ce(i,r)||i.push(r));return i},he=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"].concat("length","prototype");Kt.f=Object.getOwnPropertyNames||function(t){return le(t,he)};var pe={};pe.f=Object.getOwnPropertySymbols;var de=Kt,ye=pe,ge=B,me=Qt("Reflect","ownKeys")||function(t){var e=de.f(ge(t)),r=ye.f;return r?e.concat(r(t)):e},ve=O,Ee=me,Se=n,we=U,_e=o,be=/#|\.prototype\./,Te=function(t,e){var r=Re[Oe(t)];return r==Ie||r!=Ae&&("function"==typeof e?_e(e):!!e)},Oe=Te.normalize=function(t){return String(t).replace(be,".").toLowerCase()},Re=Te.data={},Ae=Te.NATIVE="N",Ie=Te.POLYFILL="P",je=Te,Pe=r,xe=n.f,Ne=Y,Me=Z.exports,De=X,Ce=function(t,e){for(var r=Ee(e),n=we.f,o=Se.f,i=0;i<r.length;i++){var a=r[i];ve(t,a)||n(t,a,o(e,a))}},ze=je,ke=function(t,e){var r,n,o,i,a,u=t.target,s=t.global,c=t.stat;if(r=s?Pe:c?Pe[u]||De(u,{}):(Pe[u]||{}).prototype)for(n in e){if(i=e[n],o=t.noTargetGet?(a=xe(r,n))&&a.value:r[n],!ze(s?n:u+(c?".":"#")+n,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;Ce(i,o)}(t.sham||o&&o.sham)&&Ne(i,"sham",!0),Me(r,n,i,t)}},$e=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t},Ue=B,Fe=$e,Be=function(){for(var t=Ue(this),e=Fe(t.add),r=0,n=arguments.length;r<n;r++)e.call(t,arguments[r]);return t};ke({target:"Set",proto:!0,real:!0,forced:false},{addAll:function(){return Be.apply(this,arguments)}});var Ge=B,Le=$e,qe=function(){for(var t,e=Ge(this),r=Le(e.delete),n=!0,o=0,i=arguments.length;o<i;o++)t=r.call(e,arguments[o]),n=n&&t;return!!n},Qe=qe;ke({target:"Set",proto:!0,real:!0,forced:false},{deleteAll:function(){return Qe.apply(this,arguments)}});var Ke,Ve,We=Qt("navigator","userAgent")||"",Ye=r.process,Ze=Ye&&Ye.versions,He=Ze&&Ze.v8;He?Ve=(Ke=He.split("."))[0]<4?1:Ke[0]+Ke[1]:We&&(!(Ke=We.match(/Edge\/(\d+)/))||Ke[1]>=74)&&(Ke=We.match(/Chrome\/(\d+)/))&&(Ve=Ke[1]);var Je=Ve&&+Ve,Xe=o,tr=!!Object.getOwnPropertySymbols&&!Xe((function(){return!String(Symbol())||!Symbol.sham&&Je&&Je<41})),er=tr&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,rr=r,nr=st.exports,or=O,ir=yt,ar=tr,ur=er,sr=nr("wks"),cr=rr.Symbol,fr=ur?cr:cr&&cr.withoutSetter||ir,lr=function(t){return or(sr,t)&&(ar||"string"==typeof sr[t])||(ar&&or(cr,t)?sr[t]=cr[t]:sr[t]=fr("Symbol."+t)),sr[t]},hr=B,pr=$e,dr=lr("species"),yr=function(t,e){var r,n=hr(t).constructor;return void 0===n||null==(r=hr(n)[dr])?e:pr(r)},gr={},mr=gr,vr=lr("iterator"),Er=Array.prototype,Sr=$e,wr=function(t,e,r){if(Sr(t),void 0===e)return t;switch(r){case 0:return function(){return t.call(e)};case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,o){return t.call(e,r,n,o)}}return function(){return t.apply(e,arguments)}},_r={};_r[lr("toStringTag")]="z";var br="[object z]"===String(_r),Tr=h,Or=lr("toStringTag"),Rr="Arguments"==Tr(function(){return arguments}()),Ar=br?Tr:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),Or))?r:Rr?Tr(e):"Object"==(n=Tr(e))&&"function"==typeof e.callee?"Arguments":n},Ir=gr,jr=lr("iterator"),Pr=function(t){if(null!=t)return t[jr]||t["@@iterator"]||Ir[Ar(t)]},xr=B,Nr=B,Mr=function(t){return void 0!==t&&(mr.Array===t||Er[vr]===t)},Dr=Jt,Cr=wr,zr=Pr,kr=function(t){var e=t.return;if(void 0!==e)return xr(e.call(t)).value},$r=function(t,e){this.stopped=t,this.result=e},Ur=function(t,e,r){var n,o,i,a,u,s,c,f=r&&r.that,l=!(!r||!r.AS_ENTRIES),h=!(!r||!r.IS_ITERATOR),p=!(!r||!r.INTERRUPTED),d=Cr(e,f,1+l+p),y=function(t){return n&&kr(n),new $r(!0,t)},g=function(t){return l?(Nr(t),p?d(t[0],t[1],y):d(t[0],t[1])):p?d(t,y):d(t)};if(h)n=t;else{if("function"!=typeof(o=zr(t)))throw TypeError("Target is not iterable");if(Mr(o)){for(i=0,a=Dr(t.length);a>i;i++)if((u=g(t[i]))&&u instanceof $r)return u;return new $r(!1)}n=o.call(t)}for(s=n.next;!(c=s.call(n)).done;){try{u=g(c.value)}catch(t){throw kr(n),t}if("object"==typeof u&&u&&u instanceof $r)return u}return new $r(!1)},Fr=Qt,Br=B,Gr=$e,Lr=yr,qr=Ur;ke({target:"Set",proto:!0,real:!0,forced:false},{difference:function(t){var e=Br(this),r=new(Lr(e,Fr("Set")))(e),n=Gr(r.delete);return qr(t,(function(t){n.call(r,t)})),r}});var Qr=B,Kr=Pr,Vr=function(t){return Set.prototype.values.call(t)},Wr=B,Yr=wr,Zr=Vr,Hr=Ur;ke({target:"Set",proto:!0,real:!0,forced:false},{every:function(t){var e=Wr(this),r=Zr(e),n=Yr(t,arguments.length>1?arguments[1]:void 0,3);return!Hr(r,(function(t,r){if(!n(t,t,e))return r()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var Jr=Qt,Xr=B,tn=$e,en=wr,rn=yr,nn=Vr,on=Ur;ke({target:"Set",proto:!0,real:!0,forced:false},{filter:function(t){var e=Xr(this),r=nn(e),n=en(t,arguments.length>1?arguments[1]:void 0,3),o=new(rn(e,Jr("Set"))),i=tn(o.add);return on(r,(function(t){n(t,t,e)&&i.call(o,t)}),{IS_ITERATOR:!0}),o}});var an=B,un=wr,sn=Vr,cn=Ur;ke({target:"Set",proto:!0,real:!0,forced:false},{find:function(t){var e=an(this),r=sn(e),n=un(t,arguments.length>1?arguments[1]:void 0,3);return cn(r,(function(t,r){if(n(t,t,e))return r(t)}),{IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var fn=Qt,ln=B,hn=$e,pn=yr,dn=Ur;ke({target:"Set",proto:!0,real:!0,forced:false},{intersection:function(t){var e=ln(this),r=new(pn(e,fn("Set"))),n=hn(e.has),o=hn(r.add);return dn(t,(function(t){n.call(e,t)&&o.call(r,t)})),r}});var yn=B,gn=$e,mn=Ur;ke({target:"Set",proto:!0,real:!0,forced:false},{isDisjointFrom:function(t){var e=yn(this),r=gn(e.has);return!mn(t,(function(t,n){if(!0===r.call(e,t))return n()}),{INTERRUPTED:!0}).stopped}});var vn=Qt,En=B,Sn=$e,wn=function(t){var e=Kr(t);if("function"!=typeof e)throw TypeError(String(t)+" is not iterable");return Qr(e.call(t))},_n=Ur;ke({target:"Set",proto:!0,real:!0,forced:false},{isSubsetOf:function(t){var e=wn(this),r=En(t),n=r.has;return"function"!=typeof n&&(r=new(vn("Set"))(t),n=Sn(r.has)),!_n(e,(function(t,e){if(!1===n.call(r,t))return e()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var bn=B,Tn=$e,On=Ur;ke({target:"Set",proto:!0,real:!0,forced:false},{isSupersetOf:function(t){var e=bn(this),r=Tn(e.has);return!On(t,(function(t,n){if(!1===r.call(e,t))return n()}),{INTERRUPTED:!0}).stopped}});var Rn=B,An=Vr,In=Ur;ke({target:"Set",proto:!0,real:!0,forced:false},{join:function(t){var e=Rn(this),r=An(e),n=void 0===t?",":String(t),o=[];return In(r,o.push,{that:o,IS_ITERATOR:!0}),o.join(n)}});var jn=Qt,Pn=B,xn=$e,Nn=wr,Mn=yr,Dn=Vr,Cn=Ur;ke({target:"Set",proto:!0,real:!0,forced:false},{map:function(t){var e=Pn(this),r=Dn(e),n=Nn(t,arguments.length>1?arguments[1]:void 0,3),o=new(Mn(e,jn("Set"))),i=xn(o.add);return Cn(r,(function(t){i.call(o,n(t,t,e))}),{IS_ITERATOR:!0}),o}});var zn=B,kn=$e,$n=Vr,Un=Ur;ke({target:"Set",proto:!0,real:!0,forced:false},{reduce:function(t){var e=zn(this),r=$n(e),n=arguments.length<2,o=n?void 0:arguments[1];if(kn(t),Un(r,(function(r){n?(n=!1,o=r):o=t(o,r,r,e)}),{IS_ITERATOR:!0}),n)throw TypeError("Reduce of empty set with no initial value");return o}});var Fn=B,Bn=wr,Gn=Vr,Ln=Ur;ke({target:"Set",proto:!0,real:!0,forced:false},{some:function(t){var e=Fn(this),r=Gn(e),n=Bn(t,arguments.length>1?arguments[1]:void 0,3);return Ln(r,(function(t,r){if(n(t,t,e))return r()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var qn=Qt,Qn=B,Kn=$e,Vn=yr,Wn=Ur;ke({target:"Set",proto:!0,real:!0,forced:false},{symmetricDifference:function(t){var e=Qn(this),r=new(Vn(e,qn("Set")))(e),n=Kn(r.delete),o=Kn(r.add);return Wn(t,(function(t){n.call(r,t)||o.call(r,t)})),r}});var Yn=Qt,Zn=B,Hn=$e,Jn=yr,Xn=Ur;ke({target:"Set",proto:!0,real:!0,forced:false},{union:function(t){var e=Zn(this),r=new(Jn(e,Yn("Set")))(e);return Xn(t,Hn(r.add),{that:r}),r}});var to=qe;ke({target:"Map",proto:!0,real:!0,forced:false},{deleteAll:function(){return to.apply(this,arguments)}});var eo=function(t){return Map.prototype.entries.call(t)},ro=B,no=wr,oo=eo,io=Ur;ke({target:"Map",proto:!0,real:!0,forced:false},{every:function(t){var e=ro(this),r=oo(e),n=no(t,arguments.length>1?arguments[1]:void 0,3);return!io(r,(function(t,r,o){if(!n(r,t,e))return o()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var ao=Qt,uo=B,so=$e,co=wr,fo=yr,lo=eo,ho=Ur;ke({target:"Map",proto:!0,real:!0,forced:false},{filter:function(t){var e=uo(this),r=lo(e),n=co(t,arguments.length>1?arguments[1]:void 0,3),o=new(fo(e,ao("Map"))),i=so(o.set);return ho(r,(function(t,r){n(r,t,e)&&i.call(o,t,r)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}});var po=B,yo=wr,go=eo,mo=Ur;ke({target:"Map",proto:!0,real:!0,forced:false},{find:function(t){var e=po(this),r=go(e),n=yo(t,arguments.length>1?arguments[1]:void 0,3);return mo(r,(function(t,r,o){if(n(r,t,e))return o(r)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var vo=B,Eo=wr,So=eo,wo=Ur;ke({target:"Map",proto:!0,real:!0,forced:false},{findKey:function(t){var e=vo(this),r=So(e),n=Eo(t,arguments.length>1?arguments[1]:void 0,3);return wo(r,(function(t,r,o){if(n(r,t,e))return o(t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var _o=B,bo=eo,To=function(t,e){return t===e||t!=t&&e!=e},Oo=Ur;ke({target:"Map",proto:!0,real:!0,forced:false},{includes:function(t){return Oo(bo(_o(this)),(function(e,r,n){if(To(r,t))return n()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var Ro=B,Ao=eo,Io=Ur;ke({target:"Map",proto:!0,real:!0,forced:false},{keyOf:function(t){return Io(Ao(Ro(this)),(function(e,r,n){if(r===t)return n(e)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var jo=Qt,Po=B,xo=$e,No=wr,Mo=yr,Do=eo,Co=Ur;ke({target:"Map",proto:!0,real:!0,forced:false},{mapKeys:function(t){var e=Po(this),r=Do(e),n=No(t,arguments.length>1?arguments[1]:void 0,3),o=new(Mo(e,jo("Map"))),i=xo(o.set);return Co(r,(function(t,r){i.call(o,n(r,t,e),r)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}});var zo=Qt,ko=B,$o=$e,Uo=wr,Fo=yr,Bo=eo,Go=Ur;ke({target:"Map",proto:!0,real:!0,forced:false},{mapValues:function(t){var e=ko(this),r=Bo(e),n=Uo(t,arguments.length>1?arguments[1]:void 0,3),o=new(Fo(e,zo("Map"))),i=$o(o.set);return Go(r,(function(t,r){i.call(o,t,n(r,t,e))}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}});var Lo=B,qo=$e,Qo=Ur;ke({target:"Map",proto:!0,real:!0,forced:false},{merge:function(t){for(var e=Lo(this),r=qo(e.set),n=0;n<arguments.length;)Qo(arguments[n++],r,{that:e,AS_ENTRIES:!0});return e}});var Ko=B,Vo=$e,Wo=eo,Yo=Ur;ke({target:"Map",proto:!0,real:!0,forced:false},{reduce:function(t){var e=Ko(this),r=Wo(e),n=arguments.length<2,o=n?void 0:arguments[1];if(Vo(t),Yo(r,(function(r,i){n?(n=!1,o=i):o=t(o,i,r,e)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),n)throw TypeError("Reduce of empty map with no initial value");return o}});var Zo=B,Ho=wr,Jo=eo,Xo=Ur;ke({target:"Map",proto:!0,real:!0,forced:false},{some:function(t){var e=Zo(this),r=Jo(e),n=Ho(t,arguments.length>1?arguments[1]:void 0,3);return Xo(r,(function(t,r,o){if(n(r,t,e))return o()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var ti=B,ei=$e;function ri(t,e){return function(r,...n){if(t.has(r)){const o=t.get(r);return n.forEach((t=>o.add(t))),e}throw new SyntaxError(`Archetype "${r}" does not exist.`)}}function ni(t){return function(){return[...t.entries()]}}function oi(t){return function(e){return t.get(e)}}function ii(t){return function(...e){const r=new Set;return e.forEach((e=>{t.forEach(((t,n)=>{(e.id&n)>0&&t.forEach((t=>r.add(t)))}))})),[...r]}}function ai(t){return function(e){return Boolean(0===t.get(e)?.size)}}function ui(t,e){return function(r,...n){if(t.has(r)){const o=t.get(r);return n.forEach((t=>o.delete(t))),e}throw new SyntaxError(`Archetype "${r}" does not exist.`)}}function si(t,e){return function(r,n){if(void 0!==n){const e=t.get(n);e&&(e.delete(r),0===e.size&&t.delete(n))}const o=r.getArchetype();return t.has(o)?t.get(o).add(r):t.set(o,new Set([r])),e}}function ci(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function fi(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ci(Object(r),!0).forEach((function(e){li(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ci(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function li(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}ke({target:"Map",proto:!0,real:!0,forced:false},{update:function(t,e){var r=ti(this),n=arguments.length;ei(e);var o=r.has(t);if(!o&&n<3)throw TypeError("Updating absent value");var i=o?r.get(t):ei(n>2?arguments[2]:void 0)(t,r);return r.set(t,e(i,t,r)),r}});const hi=Object.freeze(["_world","defaults","id","name","constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","prototype","toLocaleString","toString","valueOf","__defineGetter__","__defineSetter__","__lookupGetter__","__lookupGetter__","__proto__"]);function pi(t,e,r){return null!=e&&t<e?e:null!=r&&t>r?r:t}function di(t){return/^(?![0-9])[a-zA-Z0-9$_]+$/.test(t)&&!hi.includes(t)}function yi(t){return Boolean(t&&"object"==typeof t&&!Array.isArray(t))}function gi(t,...e){if(!e||!e.length)return t;const r={},n=e.shift();return yi(t)&&yi(n)&&(Object.keys(n).forEach((t=>{const e=Object.getOwnPropertyDescriptor(n,t);void 0!==e&&(r[t]=fi({},e),yi(e.value)?gi(e.value,n[t]):Array.isArray(e.value)&&(e.value=[...n[t]]))})),Object.getOwnPropertySymbols(n).forEach((t=>{const e=Object.getOwnPropertyDescriptor(n,t);void 0!==e&&e.enumerable&&(r[t]=fi({},e),yi(e.value)?gi(e.value,n[t]):Array.isArray(e.value)&&(e.value=[...n[t]]))})),Object.defineProperties(t,r)),gi(t,...e)}class mi{constructor(t,e,r){const{name:n}=r;this.id=e,this.name=n,this._world=t,this.defaults=gi({},r.defaults),Object.keys(this.defaults).forEach((t=>{Object.defineProperty(this,t,Object.getOwnPropertyDescriptor(this.defaults,t))}))}getEntities(){return this._world.getEntitiesByComponents(this)}isRegistered(){return this._world.isComponentRegistered(this)}}function vi(t){return function(){return[...t.values()]}}function Ei(t){return function(e){return[...t.values()].find((t=>t.id===e))}}function Si(t){return function(e){return t.get(e)}}function wi(t){return function(e){return t.has(e.name)||[...t.values()].includes(e)}}function _i(t,e,r,n){return function(o){if(t.size>=r)throw new Error("Maximum number of components reached.");if(!di(o.name))throw new SyntaxError(`"${o.name}" is not a valid component name.`);if(t.has(o.name))throw new Error(`Component with name "${o.name}" already registered.`);e.value+=1n;const i=new mi(n,e.value,o);return t.set(i.name,i),i}}function bi(t,e){return function(r){if(!t.has(r.name))throw new Error(`Component "${r.name}" is not registered.`);return r.getEntities().forEach((t=>t.removeComponent(r))),t.delete(r.name),e}}class Ti{constructor(t){const{create:e,destroy:r,initialSize:n,growthFactor:o,maxSize:i,world:a}=t;this.initialSize=n,this.growthFactor=o,this.maxSize=i,this._create=e,this._destroy=r,this._firstAvailable=null,this._pool=new Array(n),this._world=a,this.add(n)}add(t=1){for(let e=0;e<t;e++){if(this._pool.length>=this.maxSize)throw new Error("The pool is full!");const t=this._create(this._world);t.next=this._firstAvailable,this._firstAvailable=t,this._pool.push(t)}}clear(){this._pool.length=0,this._firstAvailable=null,this.add(this.initialSize)}get(){this._firstAvailable||this.add(this.initialSize*this.growthFactor);const t=this._firstAvailable;return this._firstAvailable=t.next,t}release(t){this._destroy(t),t.next=this._firstAvailable,this._firstAvailable=t}}class Oi{constructor(t){this.id=`${Date.now().toString(36)}_${Math.random().toString(36).substr(2,9)}`,this._archetype=0n,this._enabled=!1,this._next=null,this._properties=new Map,this._world=t}get enabled(){return this._enabled}get next(){return this._next}set next(t){this._next=t}addComponent(t,e){if("string"==typeof t){const e=this._world.getComponentByName(t);if(!e)throw new Error(`Component "${t}" not found!`);t=e}if(t instanceof mi){if(this._properties.has(t))throw new Error(`Entity already has component "${t.name}".`);this._properties.set(t,gi({},t.defaults,e??{})),Object.defineProperty(this,t.name,{get:()=>this._properties.get(t),set:e=>{const r=this._properties.get(t);if(Object.isFrozen(r))throw new Error(`Properties in component "${t.name}" cannot be modified.`);if(!r)throw new Error(`Component "${t.name}" does not exist in entity.`);Object.entries(e).forEach((([e,n])=>{if(!(e in r))throw new Error(`Property "${e}" does not exist in component "${t.name}".`);r[e]=n}))},enumerable:!0,configurable:!0});const r=this._archetype;return this._archetype|=1n<<t.id,this._world.updateArchetype(this,r),this}throw new SyntaxError("Invalid or unregistered component.")}clear(){const t=this._archetype;return this._archetype=0n,this._world.updateArchetype(this,t),Object.keys(this._properties).forEach((t=>delete this[t])),this._properties.clear(),this}disable(){return this._enabled=!1,this}enable(){return this._enabled=!0,this}getArchetype(){return this._archetype}hasComponent(t){const e="string"==typeof t?t:t.name;return Boolean(Reflect.has(this._properties,e))}removeComponent(t){if("string"==typeof t){const e=this._world.getComponentByName(t);if(!e)throw new Error(`Component "${t}" not found!`);t=e}if(!this._properties.has(t))throw new Error(`Entity ${this.id} has no component "${t.name}".`);this._properties.delete(t);try{delete this[t.name]}catch(e){console.warn(`Could not remove property ${t.name} from entity.`)}const e=this._archetype;return this._archetype&=~(1n<<t.id),this._world.updateArchetype(this,e),this}}function Ri(t,e,r){return function(){const n=t.get();if(!(n&&n instanceof Oi))throw new Error("No entities left! Pool is empty.");return e.set(n.id,n),r.updateArchetype(n),n}}function Ai(t,e,r){return function(n){if(n===r.global)throw new Error("Destroying the global entity is forbidden.");return!!e.has(n.id)&&(r.removeEntitiesFromArchetype(n.getArchetype(),n),e.delete(n.id),t.release(n),!0)}}function Ii(t){return function(){return[...t.values()]}}function ji(t){return function(e){return t.get(e)}}function Pi(t){return function(e){return t.has(e.id)||[...t.values()].includes(e)}}function xi(t){return t.reduce(((t,e)=>t|=1n<<e.id),0n)}class Ni{constructor(t,e){const{all:r=[],any:n=[],none:o=[]}=e;this._mskAll=xi(r),this._mskAny=xi(n),this._mskNone=xi(o),this._registry=new Set,this._world=t}get size(){return this._registry.size}getEntities(){return[...this._registry]}hasEntity(t){return this._registry.has(t)}matches(t){const e=0n===this._mskAny||(t&this._mskAny)>0,r=(t&this._mskAll)===this._mskAll,n=0n===(t&this._mskNone);return e&&r&&n}update(){this._registry.clear(),this._world.getArchetypes().forEach((([t,e])=>{this.matches(t)&&e.forEach((t=>this._registry.add(t)))}))}}function Mi(t){return function(e){return t.has(e)}}function Di(t,e){return function(r){const n=new Ni(e,r);return t.add(n),n}}function Ci(t,e){return function(){return t.forEach((t=>t.update())),e}}function zi(t,e){return function(r){return t.delete(r),e}}function ki(t,e,r){let n=0,o=null,i=0;const a=e,u=function(t){return function(){return t.getPreSystems().forEach((e=>e.pre(e.entities,t.global))),t}}(r),s=function(t){return function(e=0){return t.getPostSystems().forEach((r=>r.post(r.entities,t.global,e))),t.refreshQueries(),t}}(r),c=function(t){return function(e=0){return t.getUpdateSystems().forEach((r=>r.update(r.entities,t.global,e))),t}}(r);return function(r=0){if(null!==o)for(n+=.001*(r-o),i=0,u();n>a;){if(i>=t){n=1;break}c(a),n-=a,i++}o=r,s(n/e)}}function $i(t,e){}function Ui(t,e,r){}function Fi(t,e,r){}class Bi{constructor(t,e){const{name:r,query:n=null,pre:o=$i,post:i=Ui,update:a=Fi}=e;this.name=r,this.query=n,this.pre=o,this.post=i,this.update=a,this._enabled=!1,this._world=t}get enabled(){return this._enabled}get entities(){return null===this.query?this._world.getEntities():this.query.getEntities()}disable(){this._enabled=!1}enable(){this._enabled=!0}}function Gi(t){return function(){return[...t]}}function Li(t){return function(){return t.filter((t=>t.post&&t.post!==Ui&&t.enabled))}}function qi(t){return function(){return t.filter((t=>t.pre&&t.pre!==$i&&t.enabled))}}function Qi(t){return function(){return t.filter((t=>t.update&&t.update!==Fi&&t.enabled))}}function Ki(t){return function(e){return t[e]}}function Vi(t){return function(e){return t.get(e)}}function Wi(t){return function(e){return t.has(e.name)||[...t.values()].includes(e)}}function Yi(t){return function(e,r){const n=t.indexOf(e);if(-1===n)return-1;const o=pi(r,0,t.length);return t.splice(o,1),t.splice(n,0,e),o}}function Zi(t,e,r){return function(n,o){if(!di(n.name))throw new SyntaxError(`"${n.name}" is not a valid system name.`);if(e.has(n.name))throw new Error(`System "${n.name}" is already registered!`);const i=new Bi(r,n);return void 0!==o?t.splice(pi(o,0,t.length),0,i):t.push(i),e.set(i.name,i),i}}function Hi(t,e,r){return function(n){if(!e.has(n.name))throw new Error(`System "${n.name}" is not registered!`);e.delete(n.name);const o=t.indexOf(n);return o>-1&&t.splice(o,1),r}}exports.createWorld=function(t={}){const{entityPoolGrowthFactor:e=.25,initialEntityPoolSize:r=128,maxComponents:n=256,maxEntities:o=Number.POSITIVE_INFINITY,maxUpdates:i=240,tempo:a=1/60}=t,u=Object.create(null);return Object.assign(u,function(t,e){const r=new Map;return{addEntitiesToArchetype:ri(r,t),getArchetypes:ni(r),getEntitiesFromArchetype:oi(r),getEntitiesByComponents:ii(r),isArchetypeEmpty:ai(r),removeEntitiesFromArchetype:ui(r,t),updateArchetype:si(r,t)}}(u),function(t,e){const{maxComponents:r}=e,n=new Map;return{getComponentById:Ei(n),getComponentByName:Si(n),getComponents:vi(n),isComponentRegistered:wi(n),registerComponent:_i(n,{value:0n},r,t),unregisterComponent:bi(n,t)}}(u,{maxComponents:n}),function(t,e){const{entityPoolGrowthFactor:r,initialEntityPoolSize:n,maxEntities:o}=e,i=new Ti({create:function(){return new Oi(t)},destroy:function(t){t.clear()},initialSize:n,growthFactor:r,maxSize:o,world:t}),a=new Map;return{createEntity:Ri(i,a,t),destroyEntity:Ai(i,a,t),getEntities:Ii(a),getEntityById:ji(a),isEntityRegistered:Pi(a)}}(u,{entityPoolGrowthFactor:e,initialEntityPoolSize:r,maxEntities:o}),function(t,e){const r=new Set;return{isQueryRegistered:Mi(r),registerQuery:Di(r,t),refreshQueries:Ci(r,t),unregisterQuery:zi(r,t)}}(u),function(t,e){const{maxUpdates:r,tempo:n}=e;return{step:ki(r,n,t)}}(u,{maxUpdates:i,tempo:a}),function(t,e){const r=[],n=new Map;return{getSystems:Gi(r),getPostSystems:Li(r),getPreSystems:qi(r),getUpdateSystems:Qi(r),getSystemByIdx:Ki(r),getSystemByName:Vi(n),isSystemRegistered:Wi(n),moveSystem:Yi(r),registerSystem:Zi(r,n,t),unregisterSystem:Hi(r,n,t)}}(u)),u.global=u.createEntity(),u.FORBIDDEN_NAMES=[...hi],u};
//# sourceMappingURL=index.min.js.map
